# 通用Linux权限

## 提权的作用

#### “权限升级”是什么意思？  

从本质上讲，权限升级通常涉及从较低权限到较高权限。从技术上讲，这是一种 剥削漏洞 、设计缺陷或配置疏忽在操作系统或应用程序中获取对通常限制用户访问的资源的未授权访问。

#### 它为什么如此重要？

在进行 CTF 或实际渗透测试时，您很少能够获得为您提供管理员访问权限的立足点（初始访问权限）。权限升级至关重要，因为它可以让您获得系统管理员级别的访问权限。这允许您做很多事情，包括：

- 重置密码  
- 绕过访问控制以危害受保护的数据  
- 编辑软件配置  
- 启用持久性，以便您稍后可以再次访问该计算机。  
- 更改用户权限
- 获取那个厚颜无耻的根标志；）以及您想要的任何其他管理员或超级用户命令。

## 提权的方向

#### 有两种主要的权限提升变体：

水平权限提升： 您可以通过接管与您具有相同权限级别的其他用户来扩大对受感染系统的影响范围。例如，一个普通用户劫持另一个普通用户（而不是提升为超级用户）。这允许您继承用户拥有的任何文件和访问权限。例如，这可以用来获得对另一个普通权限用户的访问权限，该用户恰好有一个 SUID 文件附加到其主目录（稍后会详细介绍），然后可以使用该文件来获得超级用户访问权限。[在树上横向移动]

垂直 权限提升（权限提升）： 这是您尝试使用已被泄露的现有帐户获得更高权限或访问权限的地方。对于本地权限提升攻击，这可能意味着劫持具有管理员权限或 root 权限的帐户。[爬上树]

## 枚举

工具Linenum

## SUID/GUID文件

查找并利用 SUID 文件

Linux权限提升利用的第一步是检查设置了 SUID/GUID 位的文件。这意味着可以使用文件所有者/组的权限运行一个或多个文件。在本例中，作为超级用户。我们可以利用它来获得具有这些权限的 shell！

什么是 SUID 二进制文件？

众所周知，在Linux中一切都是文件，包括目录和设备，它们都有权限允许或限制读/写/执行三种操作。因此，当您为任何文件设置权限时，您应该了解您允许或限制所有三种权限的 Linux 用户。看一下下面的演示，了解最大权限 (rwx-rwx-rwx) 的外观：

r = 读

w = 写

x = 执行

|    用户     |组|     其他|
|-|-|-|
RWX |RWX|RWX
421 |421 |421

可用于为每个用户设置权限的最大位数为 7，这是读 (4)、写 (2) 和执行 (1) 操作的组合。例如，如果您使用“chmod”将权限设置为755，那么它将是：rwxr-xr-x。


但是，当向每个用户授予特殊权限时，它就变成了 SUID 或 SGID。当额外位“4”设置为用户（所有者）时，它变为SUID（设置用户 ID），当位“2”设置为组时，它变为SGID（设置组 ID）。

因此，查找SUID时要查找的权限为：

苏伊德：  
rws-rwx-rwx  
GUID：  
rwx-rws-rwx  

查找 SUID 二进制文件  
通过 LinEnum 扫描，我们已经知道系统上存在支持 SUID 的文件。但是，如果我们想手动执行此操作，我们可以使用命令：“find / -perm -u=s -type f 2>/dev/null”在文件系统中搜索 SUID/GUID 文件。让我们分解一下这个命令。

find - 启动“查找”命令
- / - 搜索整个文件系统
- -perm - 搜索具有特定权限的文件
- -u=s -为文件设置任何权限位模式。这种形式接受符号模式
- -type f - 仅搜索文件
- 2>/dev/null - 抑制错误

猜想：所以如果查找GUID文件应该就是"-g=s"  

## 利用可写的/etc/passwd文件

条件
用户要有读写/etc/passwd的权限

大致上就是拿到有读写/etc/passwd文件的权限，然后用openssl生成一个合规的密码哈希，然后用编辑器添加到/etc/passwd里面，再用su 用户来拿到root

openssl命令  
openssl passwd -1 -salt [用户名] [密码]  
添加格式  
用户名:密码哈希:0:0:root:/root:/bin/bash  

## 转义vi编辑器

## 利用crontab


